/**
* 2005-2017 Magic Toolbox
*
* NOTICE OF LICENSE
*
* This file is licenced under the Software License Agreement.
* With the purchase or the installation of the software in your application
* you accept the licence agreement.
*
* You must not modify, adapt or create derivative works of this source code
*
*  @author    Magic Toolbox <support@magictoolbox.com>
*  @copyright Copyright (c) 2017 Magic Toolbox <support@magictoolbox.com>. All rights reserved
*  @license   https://www.magictoolbox.com/license/
*/

/*


   Magic Scroll v2.0.32
   Copyright 2017 Magic Toolbox
   Buy a license: https://www.magictoolbox.com/magicscroll/
   License agreement: https://www.magictoolbox.com/license/


*/
window.MagicScroll=(function(){var p,q;p=q=(function(){var N={version:"v3.3-b3-9-g7dd0194",UUID:0,storage:{},$uuid:function(R){return(R.$J_UUID||(R.$J_UUID=++H.UUID))},getStorage:function(R){return(H.storage[R]||(H.storage[R]={}))},$F:function(){},$false:function(){return false},$true:function(){return true},stylesId:"mjs-"+Math.floor(Math.random()*new Date().getTime()),defined:function(R){return(undefined!=R)},ifndef:function(S,R){return(undefined!=S)?S:R},exists:function(R){return!!(R)},jTypeOf:function(R){if(!H.defined(R)){return false}if(R.$J_TYPE){return R.$J_TYPE}if(!!R.nodeType){if(1==R.nodeType){return"element"}if(3==R.nodeType){return"textnode"}}if(R.length&&R.item){return"collection"}if(R.length&&R.callee){return"arguments"}if((R instanceof window.Object||R instanceof window.Function)&&R.constructor===H.Class){return"class"}if(R instanceof window.Array){return"array"}if(R instanceof window.Function){return"function"}if(R instanceof window.String){return"string"}if(H.jBrowser.trident){if(H.defined(R.cancelBubble)){return"event"}}else{if(R===window.event||R.constructor==window.Event||R.constructor==window.MouseEvent||R.constructor==window.UIEvent||R.constructor==window.KeyboardEvent||R.constructor==window.KeyEvent){return"event"}}if(R instanceof window.Date){return"date"}if(R instanceof window.RegExp){return"regexp"}if(R===window){return"window"}if(R===document){return"document"}return typeof(R)},extend:function(W,V){if(!(W instanceof window.Array)){W=[W]}if(!V){return W[0]}for(var U=0,S=W.length;U<S;U++){if(!H.defined(W)){continue}for(var T in V){if(!Object.prototype.hasOwnProperty.call(V,T)){continue}try{W[U][T]=V[T]}catch(R){}}}return W[0]},implement:function(V,U){if(!(V instanceof window.Array)){V=[V]}for(var T=0,R=V.length;T<R;T++){if(!H.defined(V[T])){continue}if(!V[T].prototype){continue}for(var S in(U||{})){if(!V[T].prototype[S]){V[T].prototype[S]=U[S]}}}return V[0]},nativize:function(T,S){if(!H.defined(T)){return T}for(var R in(S||{})){if(!T[R]){T[R]=S[R]}}return T},$try:function(){for(var S=0,R=arguments.length;S<R;S++){try{return arguments[S]()}catch(T){}}return null},$A:function(T){if(!H.defined(T)){return H.$([])}if(T.toArray){return H.$(T.toArray())}if(T.item){var S=T.length||0,R=new Array(S);while(S--){R[S]=T[S]}return H.$(R)}return H.$(Array.prototype.slice.call(T))},now:function(){return new Date().getTime()},detach:function(V){var T;switch(H.jTypeOf(V)){case"object":T={};for(var U in V){T[U]=H.detach(V[U])}break;case"array":T=[];for(var S=0,R=V.length;S<R;S++){T[S]=H.detach(V[S])}break;default:return V}return H.$(T)},$:function(T){var R=true;if(!H.defined(T)){return null}if(T.$J_EXT){return T}switch(H.jTypeOf(T)){case"array":T=H.nativize(T,H.extend(H.Array,{$J_EXT:H.$F}));T.jEach=T.forEach;return T;break;case"string":var S=document.getElementById(T);if(H.defined(S)){return H.$(S)}return null;break;case"window":case"document":H.$uuid(T);T=H.extend(T,H.Doc);break;case"element":H.$uuid(T);T=H.extend(T,H.Element);break;case"event":T=H.extend(T,H.Event);break;case"textnode":case"function":case"array":case"date":default:R=false;break}if(R){return H.extend(T,{$J_EXT:H.$F})}else{return T}},$new:function(R,T,S){return H.$(H.doc.createElement(R)).setProps(T||{}).jSetCss(S||{})},addCSS:function(S,U,Y){var V,T,W,X=[],R=-1;Y||(Y=H.stylesId);V=H.$(Y)||H.$new("style",{id:Y,type:"text/css"}).jAppendTo((document.head||document.body),"top");T=V.sheet||V.styleSheet;if("string"!=H.jTypeOf(U)){for(var W in U){X.push(W+":"+U[W])}U=X.join(";")}if(T.insertRule){R=T.insertRule(S+" {"+U+"}",T.cssRules.length)}else{R=T.addRule(S,U)}return R},removeCSS:function(U,R){var T,S;T=H.$(U);if("element"!==H.jTypeOf(T)){return}S=T.sheet||T.styleSheet;if(S.deleteRule){S.deleteRule(R)}else{if(S.removeRule){S.removeRule(R)}}},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(T){var S=Math.random()*16|0,R=T=="x"?S:(S&3|8);return R.toString(16)}).toUpperCase()},getAbsoluteURL:(function(){var R;return function(S){if(!R){R=document.createElement("a")}R.setAttribute("href",S);return("!!"+R.href).replace("!!","")}})(),getHashCode:function(T){var U=0,R=T.length;for(var S=0;S<R;++S){U=31*U+T.charCodeAt(S);U%=4294967296}return U}};var H=N;var I=N.$;if(!window.magicJS){window.magicJS=N;window.$mjs=N.$}H.Array={$J_TYPE:"array",indexOf:function(U,V){var R=this.length;for(var S=this.length,T=(V<0)?Math.max(0,S+V):V||0;T<S;T++){if(this[T]===U){return T}}return-1},contains:function(R,S){return this.indexOf(R,S)!=-1},forEach:function(R,U){for(var T=0,S=this.length;T<S;T++){if(T in this){R.call(U,this[T],T,this)}}},filter:function(R,W){var V=[];for(var U=0,S=this.length;U<S;U++){if(U in this){var T=this[U];if(R.call(W,this[U],U,this)){V.push(T)}}}return V},map:function(R,V){var U=[];for(var T=0,S=this.length;T<S;T++){if(T in this){U[T]=R.call(V,this[T],T,this)}}return U}};H.implement(String,{$J_TYPE:"string",jTrim:function(){return this.replace(/^\s+|\s+$/g,"")},eq:function(R,S){return(S||false)?(this.toString()===R.toString()):(this.toLowerCase().toString()===R.toLowerCase().toString())},jCamelize:function(){return this.replace(/-\D/g,function(R){return R.charAt(1).toUpperCase()})},dashize:function(){return this.replace(/[A-Z]/g,function(R){return("-"+R.charAt(0).toLowerCase())})},jToInt:function(R){return parseInt(this,R||10)},toFloat:function(){return parseFloat(this)},jToBool:function(){return!this.replace(/true/i,"").jTrim()},has:function(S,R){R=R||"";return(R+this+R).indexOf(R+S+R)>-1}});N.implement(Function,{$J_TYPE:"function",jBind:function(){var S=H.$A(arguments),R=this,T=S.shift();return function(){return R.apply(T||null,S.concat(H.$A(arguments)))}},jBindAsEvent:function(){var S=H.$A(arguments),R=this,T=S.shift();return function(U){return R.apply(T||null,H.$([U||(H.jBrowser.ieMode?window.event:null)]).concat(S))}},jDelay:function(){var S=H.$A(arguments),R=this,T=S.shift();return window.setTimeout(function(){return R.apply(R,S)},T||0)},jDefer:function(){var S=H.$A(arguments),R=this;return function(){return R.jDelay.apply(R,S)}},interval:function(){var S=H.$A(arguments),R=this,T=S.shift();return window.setInterval(function(){return R.apply(R,S)},T||0)}});var O={},G=navigator.userAgent.toLowerCase(),F=G.match(/(webkit|gecko|trident|presto)\/(\d+\.?\d*)/i),K=G.match(/(edge|opr)\/(\d+\.?\d*)/i)||G.match(/(crios|chrome|safari|firefox|opera|opr)\/(\d+\.?\d*)/i),M=G.match(/version\/(\d+\.?\d*)/i),B=document.documentElement.style;function C(S){var R=S.charAt(0).toUpperCase()+S.slice(1);return S in B||("Webkit"+R)in B||("Moz"+R)in B||("ms"+R)in B||("O"+R)in B}H.jBrowser={features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector),fullScreen:!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.exitFullscreen||document.cancelFullScreen||document.webkitexitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.msCancelFullScreen),xhr2:!!(window.ProgressEvent)&&!!(window.FormData)&&(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),transition:C("transition"),transform:C("transform"),perspective:C("perspective"),animation:C("animation"),requestAnimationFrame:false,multibackground:false,cssFilters:false,svg:(function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")})()},touchScreen:function(){return"ontouchstart"in window||(window.DocumentTouch&&document instanceof DocumentTouch)}(),mobile:G.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(jBrowser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/)?true:false,engine:(F&&F[1])?F[1].toLowerCase():(window.opera)?"presto":!!(window.ActiveXObject)?"trident":(undefined!==document.getBoxObjectFor||null!=window.mozInnerScreenY)?"gecko":(null!==window.WebKitPoint||!navigator.taintEnabled)?"webkit":"unknown",version:(F&&F[2])?parseFloat(F[2]):0,uaName:(K&&K[1])?K[1].toLowerCase():"",uaVersion:(K&&K[2])?parseFloat(K[2]):0,cssPrefix:"",cssDomPrefix:"",domPrefix:"",ieMode:0,platform:G.match(/ip(?:ad|od|hone)/)?"ios":(G.match(/(?:webos|android)/)||navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),backCompat:document.compatMode&&"backcompat"==document.compatMode.toLowerCase(),scrollbarsWidth:0,getDoc:function(){return(document.compatMode&&"backcompat"==document.compatMode.toLowerCase())?document.body:document.documentElement},requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||undefined,cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||undefined,ready:false,onready:function(){if(H.jBrowser.ready){return}var U,T;H.jBrowser.ready=true;H.body=H.$(document.body);H.win=H.$(window);try{var S=H.$new("div").jSetCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).jAppendTo(document.body);H.jBrowser.scrollbarsWidth=S.offsetWidth-S.clientWidth;S.jRemove()}catch(R){}try{U=H.$new("div");T=U.style;T.cssText="background:url(https://),url(https://),red url(https://)";H.jBrowser.features.multibackground=(/(url\s*\(.*?){3}/).test(T.background);T=null;U=null}catch(R){}if(!H.jBrowser.cssTransformProp){H.jBrowser.cssTransformProp=H.normalizeCSS("transform").dashize()}try{U=H.$new("div");U.style.cssText=H.normalizeCSS("filter").dashize()+":blur(2px);";H.jBrowser.features.cssFilters=!!U.style.length&&(!H.jBrowser.ieMode||H.jBrowser.ieMode>9);U=null}catch(R){}if(!H.jBrowser.features.cssFilters){H.$(document.documentElement).jAddClass("no-cssfilters-magic")}if(undefined===window.TransitionEvent&&undefined!==window.WebKitTransitionEvent){O.transitionend="webkitTransitionEnd"}H.Doc.jCallEvent.call(H.$(document),"domready")}};(function(){var V=[],U,T,S;function R(){return!!(arguments.callee.caller)}switch(H.jBrowser.engine){case"trident":if(!H.jBrowser.version){H.jBrowser.version=!!(window.XMLHttpRequest)?3:2}break;case"gecko":H.jBrowser.version=(K&&K[2])?parseFloat(K[2]):0;break}H.jBrowser[H.jBrowser.engine]=true;if(K&&"crios"===K[1]){H.jBrowser.uaName="chrome"}if(!!window.chrome){H.jBrowser.chrome=true}if(K&&"opr"===K[1]){H.jBrowser.uaName="opera";H.jBrowser.opera=true}if("safari"===H.jBrowser.uaName&&(M&&M[1])){H.jBrowser.uaVersion=parseFloat(M[1])}if("android"==H.jBrowser.platform&&H.jBrowser.webkit&&(M&&M[1])){H.jBrowser.androidBrowser=true}U=({gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"],presto:["-o-","O","o"]})[H.jBrowser.engine]||["","",""];H.jBrowser.cssPrefix=U[0];H.jBrowser.cssDomPrefix=U[1];H.jBrowser.domPrefix=U[2];H.jBrowser.ieMode=(!H.jBrowser.trident)?undefined:(document.documentMode)?document.documentMode:function(){var W=0;if(H.jBrowser.backCompat){return 5}switch(H.jBrowser.version){case 2:W=6;break;case 3:W=7;break}return W}();V.push(H.jBrowser.platform+"-magic");if(H.jBrowser.mobile){V.push("mobile-magic")}if(H.jBrowser.androidBrowser){V.push("android-jBrowser-magic")}if(H.jBrowser.ieMode){H.jBrowser.uaName="ie";H.jBrowser.uaVersion=H.jBrowser.ieMode;V.push("ie"+H.jBrowser.ieMode+"-magic");for(T=11;T>H.jBrowser.ieMode;T--){V.push("lt-ie"+T+"-magic")}}if(H.jBrowser.webkit&&H.jBrowser.version<536){H.jBrowser.features.fullScreen=false}if(H.jBrowser.requestAnimationFrame){H.jBrowser.requestAnimationFrame.call(window,function(){H.jBrowser.features.requestAnimationFrame=true})}if(H.jBrowser.features.svg){V.push("svg-magic")}else{V.push("no-svg-magic")}S=(document.documentElement.className||"").match(/\S+/g)||[];document.documentElement.className=H.$(S).concat(V).join(" ");if(H.jBrowser.ieMode&&H.jBrowser.ieMode<9){document.createElement("figure");document.createElement("figcaption")}})();(function(){H.jBrowser.fullScreen={capable:H.jBrowser.features.fullScreen,enabled:function(){return!!(document.fullscreenElement||document[H.jBrowser.domPrefix+"FullscreenElement"]||document.fullScreen||document.webkitIsFullScreen||document[H.jBrowser.domPrefix+"FullScreen"])},request:function(R,S){S||(S={});if(this.capable){H.$(document).jAddEvent(this.changeEventName,this.onchange=function(T){if(this.enabled()){S.onEnter&&S.onEnter()}else{H.$(document).jRemoveEvent(this.changeEventName,this.onchange);S.onExit&&S.onExit()}}.jBindAsEvent(this));H.$(document).jAddEvent(this.errorEventName,this.onerror=function(T){S.fallback&&S.fallback();H.$(document).jRemoveEvent(this.errorEventName,this.onerror)}.jBindAsEvent(this));(R[H.jBrowser.domPrefix+"RequestFullscreen"]||R[H.jBrowser.domPrefix+"RequestFullScreen"]||R.requestFullscreen||function(){}).call(R)}else{if(S.fallback){S.fallback()}}},cancel:(document.exitFullscreen||document.cancelFullScreen||document[H.jBrowser.domPrefix+"ExitFullscreen"]||document[H.jBrowser.domPrefix+"CancelFullScreen"]||function(){}).jBind(document),changeEventName:document.msExitFullscreen?"MSFullscreenChange":(document.exitFullscreen?"":H.jBrowser.domPrefix)+"fullscreenchange",errorEventName:document.msExitFullscreen?"MSFullscreenError":(document.exitFullscreen?"":H.jBrowser.domPrefix)+"fullscreenerror",prefix:H.jBrowser.domPrefix,activeElement:null}})();var Q=/\S+/g,E=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,J={"float":("undefined"===typeof(B.styleFloat))?"cssFloat":"styleFloat"},L={fontWeight:true,lineHeight:true,opacity:true,zIndex:true,zoom:true},D=(window.getComputedStyle)?function(T,R){var S=window.getComputedStyle(T,null);return S?S.getPropertyValue(R)||S[R]:null}:function(U,S){var T=U.currentStyle,R=null;R=T?T[S]:null;if(null==R&&U.style&&U.style[S]){R=U.style[S]}return R};function P(T){var R,S;S=(H.jBrowser.webkit&&"filter"==T)?false:(T in B);if(!S){R=H.jBrowser.cssDomPrefix+T.charAt(0).toUpperCase()+T.slice(1);if(R in B){return R}}return T}H.normalizeCSS=P;H.Element={jHasClass:function(R){return!(R||"").has(" ")&&(this.className||"").has(R," ")},jAddClass:function(V){var S=(this.className||"").match(Q)||[],U=(V||"").match(Q)||[],R=U.length,T=0;for(;T<R;T++){if(!H.$(S).contains(U[T])){S.push(U[T])}}this.className=S.join(" ");return this},jRemoveClass:function(W){var S=(this.className||"").match(Q)||[],V=(W||"").match(Q)||[],R=V.length,U=0,T;for(;U<R;U++){if((T=H.$(S).indexOf(V[U]))>-1){S.splice(T,1)}}this.className=W?S.join(" "):"";return this},jToggleClass:function(R){return this.jHasClass(R)?this.jRemoveClass(R):this.jAddClass(R)},jGetCss:function(S){var T=S.jCamelize(),R=null;S=J[T]||(J[T]=P(T));R=D(this,S);if("auto"===R){R=null}if(null!==R){if("opacity"==S){return H.defined(R)?parseFloat(R):1}if(E.test(S)){R=parseInt(R,10)?R:"0px"}}return R},jSetCssProp:function(S,R){var U=S.jCamelize();try{if("opacity"==S){this.jSetOpacity(R);return this}S=J[U]||(J[U]=P(U));this.style[S]=R+(("number"==H.jTypeOf(R)&&!L[U])?"px":"")}catch(T){}return this},jSetCss:function(S){for(var R in S){this.jSetCssProp(R,S[R])}return this},jGetStyles:function(){var R={};H.$A(arguments).jEach(function(S){R[S]=this.jGetCss(S)},this);return R},jSetOpacity:function(T,R){var S;R=R||false;this.style.opacity=T;T=parseInt(parseFloat(T)*100);if(R){if(0===T){if("hidden"!=this.style.visibility){this.style.visibility="hidden"}}else{if("visible"!=this.style.visibility){this.style.visibility="visible"}}}if(H.jBrowser.ieMode&&H.jBrowser.ieMode<9){if(!isNaN(T)){if(!~this.style.filter.indexOf("Alpha")){this.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")"}else{this.style.filter=this.style.filter.replace(/Opacity=\d*/i,"Opacity="+T)}}else{this.style.filter=this.style.filter.replace(/progid:DXImageTransform.Microsoft.Alpha\(Opacity=\d*\)/i,"").jTrim();if(""===this.style.filter){this.style.removeAttribute("filter")}}}return this},setProps:function(R){for(var S in R){if("class"===S){this.jAddClass(""+R[S])}else{this.setAttribute(S,""+R[S])}}return this},jGetTransitionDuration:function(){var S=0,R=0;S=this.jGetCss("transition-duration");R=this.jGetCss("transition-delay");S=S.indexOf("ms")>-1?parseFloat(S):S.indexOf("s")>-1?parseFloat(S)*1000:0;R=R.indexOf("ms")>-1?parseFloat(R):R.indexOf("s")>-1?parseFloat(R)*1000:0;return S+R},hide:function(){return this.jSetCss({display:"none",visibility:"hidden"})},show:function(){return this.jSetCss({display:"",visibility:"visible"})},jGetSize:function(){return{width:this.offsetWidth,height:this.offsetHeight}},getInnerSize:function(S){var R=this.jGetSize();R.width-=(parseFloat(this.jGetCss("border-left-width")||0)+parseFloat(this.jGetCss("border-right-width")||0));R.height-=(parseFloat(this.jGetCss("border-top-width")||0)+parseFloat(this.jGetCss("border-bottom-width")||0));if(!S){R.width-=(parseFloat(this.jGetCss("padding-left")||0)+parseFloat(this.jGetCss("padding-right")||0));R.height-=(parseFloat(this.jGetCss("padding-top")||0)+parseFloat(this.jGetCss("padding-bottom")||0))}return R},jGetScroll:function(){return{top:this.scrollTop,left:this.scrollLeft}},jGetFullScroll:function(){var R=this,S={top:0,left:0};do{S.left+=R.scrollLeft||0;S.top+=R.scrollTop||0;R=R.parentNode}while(R);return S},jGetPosition:function(){var V=this,S=0,U=0;if(H.defined(document.documentElement.getBoundingClientRect)){var R=this.getBoundingClientRect(),T=H.$(document).jGetScroll(),W=H.jBrowser.getDoc();return{top:R.top+T.y-W.clientTop,left:R.left+T.x-W.clientLeft}}do{S+=V.offsetLeft||0;U+=V.offsetTop||0;V=V.offsetParent}while(V&&!(/^(?:body|html)$/i).test(V.tagName));return{top:U,left:S}},jGetRect:function(){var S=this.jGetPosition();var R=this.jGetSize();return{top:S.top,bottom:S.top+R.height,left:S.left,right:S.left+R.width}},changeContent:function(S){try{this.innerHTML=S}catch(R){this.innerText=S}return this},jRemove:function(){return(this.parentNode)?this.parentNode.removeChild(this):this},kill:function(){H.$A(this.childNodes).jEach(function(R){if(3==R.nodeType||8==R.nodeType){return}H.$(R).kill()});this.jRemove();this.jClearEvents();if(this.$J_UUID){H.storage[this.$J_UUID]=null;delete H.storage[this.$J_UUID]}return null},append:function(T,S){S=S||"bottom";var R=this.firstChild;("top"==S&&R)?this.insertBefore(T,R):this.appendChild(T);return this},jAppendTo:function(T,S){var R=H.$(T).append(this,S);return this},enclose:function(R){this.append(R.parentNode.replaceChild(this,R));return this},hasChild:function(R){if("element"!==H.jTypeOf("string"==H.jTypeOf(R)?R=document.getElementById(R):R)){return false}return(this==R)?false:(this.contains&&!(H.jBrowser.webkit419))?(this.contains(R)):(this.compareDocumentPosition)?!!(this.compareDocumentPosition(R)&16):H.$A(this.byTag(R.tagName)).contains(R)}};H.Element.jGetStyle=H.Element.jGetCss;H.Element.jSetStyle=H.Element.jSetCss;if(!window.Element){window.Element=H.$F;if(H.jBrowser.engine.webkit){window.document.createElement("iframe")}window.Element.prototype=(H.jBrowser.engine.webkit)?window["[[DOMElement.prototype]]"]:{}}H.implement(window.Element,{$J_TYPE:"element"});H.Doc={jGetSize:function(){if(H.jBrowser.touchScreen||H.jBrowser.presto925||H.jBrowser.webkit419){return{width:window.innerWidth,height:window.innerHeight}}return{width:H.jBrowser.getDoc().clientWidth,height:H.jBrowser.getDoc().clientHeight}},jGetScroll:function(){return{x:window.pageXOffset||H.jBrowser.getDoc().scrollLeft,y:window.pageYOffset||H.jBrowser.getDoc().scrollTop}},jGetFullSize:function(){var R=this.jGetSize();return{width:Math.max(H.jBrowser.getDoc().scrollWidth,R.width),height:Math.max(H.jBrowser.getDoc().scrollHeight,R.height)}}};H.extend(document,{$J_TYPE:"document"});H.extend(window,{$J_TYPE:"window"});H.extend([H.Element,H.Doc],{jFetch:function(U,S){var R=H.getStorage(this.$J_UUID),T=R[U];if(undefined!==S&&undefined===T){T=R[U]=S}return(H.defined(T)?T:null)},jStore:function(T,S){var R=H.getStorage(this.$J_UUID);R[T]=S;return this},jDel:function(S){var R=H.getStorage(this.$J_UUID);delete R[S];return this}});if(!(window.HTMLElement&&window.HTMLElement.prototype&&window.HTMLElement.prototype.getElementsByClassName)){H.extend([H.Element,H.Doc],{getElementsByClassName:function(R){return H.$A(this.getElementsByTagName("*")).filter(function(T){try{return(1==T.nodeType&&T.className.has(R," "))}catch(S){}})}})}H.extend([H.Element,H.Doc],{byClass:function(){return this.getElementsByClassName(arguments[0])},byTag:function(){return this.getElementsByTagName(arguments[0])}});if(H.jBrowser.fullScreen.capable&&!document.requestFullScreen){H.Element.requestFullScreen=function(){H.jBrowser.fullScreen.request(this)}}H.Event={$J_TYPE:"event",isQueueStopped:H.$false,stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){if(this.stopPropagation){this.stopPropagation()}else{this.cancelBubble=true}return this},stopDefaults:function(){if(this.preventDefault){this.preventDefault()}else{this.returnValue=false}return this},stopQueue:function(){this.isQueueStopped=H.$true;return this},getClientXY:function(){var S,R;S=((/touch/i).test(this.type))?this.changedTouches[0]:this;return(!H.defined(S))?{x:0,y:0}:{x:S.clientX,y:S.clientY}},jGetPageXY:function(){var S,R;S=((/touch/i).test(this.type))?this.changedTouches[0]:this;return(!H.defined(S))?{x:0,y:0}:{x:S.pageX||S.clientX+H.jBrowser.getDoc().scrollLeft,y:S.pageY||S.clientY+H.jBrowser.getDoc().scrollTop}},getTarget:function(){var R=this.target||this.srcElement;while(R&&3==R.nodeType){R=R.parentNode}return R},getRelated:function(){var S=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":S=this.relatedTarget||this.fromElement;break;case"mouseout":case"pointerout":case"MSPointerOut":S=this.relatedTarget||this.toElement;break;default:return S}try{while(S&&3==S.nodeType){S=S.parentNode}}catch(R){S=null}return S},getButton:function(){if(!this.which&&this.button!==undefined){return(this.button&1?1:(this.button&2?3:(this.button&4?2:0)))}return this.which},isTouchEvent:function(){return(this.pointerType&&("touch"===this.pointerType||this.pointerType===this.MSPOINTER_TYPE_TOUCH))||(/touch/i).test(this.type)},isPrimaryTouch:function(){return this.pointerType?(("touch"===this.pointerType||this.MSPOINTER_TYPE_TOUCH===this.pointerType)&&this.isPrimary):1===this.changedTouches.length&&(this.targetTouches.length?this.targetTouches[0].identifier==this.changedTouches[0].identifier:true)}};H._event_add_="addEventListener";H._event_del_="removeEventListener";H._event_prefix_="";if(!document.addEventListener){H._event_add_="attachEvent";H._event_del_="detachEvent";H._event_prefix_="on"}H.Event.Custom={type:"",x:null,y:null,timeStamp:null,button:null,target:null,relatedTarget:null,$J_TYPE:"event.custom",isQueueStopped:H.$false,events:H.$([]),pushToEvents:function(R){var S=R;this.events.push(S)},stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){this.events.jEach(function(S){try{S.stopDistribution()}catch(R){}});return this},stopDefaults:function(){this.events.jEach(function(S){try{S.stopDefaults()}catch(R){}});return this},stopQueue:function(){this.isQueueStopped=H.$true;return this},getClientXY:function(){return{x:this.clientX,y:this.clientY}},jGetPageXY:function(){return{x:this.x,y:this.y}},getTarget:function(){return this.target},getRelated:function(){return this.relatedTarget},getButton:function(){return this.button},getOriginalTarget:function(){return this.events.length>0?this.events[0].getTarget():undefined}};H.extend([H.Element,H.Doc],{jAddEvent:function(T,V,W,Z){var Y,R,U,X,S;if("string"==H.jTypeOf(T)){S=T.split(" ");if(S.length>1){T=S}}if(H.jTypeOf(T)=="array"){H.$(T).jEach(this.jAddEvent.jBindAsEvent(this,V,W,Z));return this}if(!T||!V||H.jTypeOf(T)!="string"||H.jTypeOf(V)!="function"){return this}if(T=="domready"&&H.jBrowser.ready){V.call(this);return this}T=O[T]||T;W=parseInt(W||50);if(!V.$J_EUID){V.$J_EUID=Math.floor(Math.random()*H.now())}Y=H.Doc.jFetch.call(this,"_EVENTS_",{});R=Y[T];if(!R){Y[T]=R=H.$([]);U=this;if(H.Event.Custom[T]){H.Event.Custom[T].handler.add.call(this,Z)}else{R.handle=function(aa){aa=H.extend(aa||window.e,{$J_TYPE:"event"});H.Doc.jCallEvent.call(U,T,H.$(aa))};this[H._event_add_](H._event_prefix_+T,R.handle,false)}}X={type:T,fn:V,priority:W,euid:V.$J_EUID};R.push(X);R.sort(function(ab,aa){return ab.priority-aa.priority});return this},jRemoveEvent:function(X){var V=H.Doc.jFetch.call(this,"_EVENTS_",{}),T,R,S,Y,W,U;W=arguments.length>1?arguments[1]:-100;if("string"==H.jTypeOf(X)){U=X.split(" ");if(U.length>1){X=U}}if(H.jTypeOf(X)=="array"){H.$(X).jEach(this.jRemoveEvent.jBindAsEvent(this,W));return this}X=O[X]||X;if(!X||H.jTypeOf(X)!="string"||!V||!V[X]){return this}T=V[X]||[];for(S=0;S<T.length;S++){R=T[S];if(-100==W||!!W&&W.$J_EUID===R.euid){Y=T.splice(S--,1)}}if(0===T.length){if(H.Event.Custom[X]){H.Event.Custom[X].handler.jRemove.call(this)}else{this[H._event_del_](H._event_prefix_+X,T.handle,false)}delete V[X]}return this},jCallEvent:function(V,X){var U=H.Doc.jFetch.call(this,"_EVENTS_",{}),T,R,S;V=O[V]||V;if(!V||H.jTypeOf(V)!="string"||!U||!U[V]){return this}try{X=H.extend(X||{},{type:V})}catch(W){}if(undefined===X.timeStamp){X.timeStamp=H.now()}T=U[V]||[];for(S=0;S<T.length&&!(X.isQueueStopped&&X.isQueueStopped());S++){T[S].fn.call(this,X)}},jRaiseEvent:function(S,R){var V=("domready"==S)?false:true,U=this,T;S=O[S]||S;if(!V){H.Doc.jCallEvent.call(this,S);return this}if(U===document&&document.createEvent&&!U.dispatchEvent){U=document.documentElement}if(document.createEvent){T=document.createEvent(S);T.initEvent(R,true,true)}else{T=document.createEventObject();T.eventType=S}if(document.createEvent){U.dispatchEvent(T)}else{U.fireEvent("on"+R,T)}return T},jClearEvents:function(){var S=H.Doc.jFetch.call(this,"_EVENTS_");if(!S){return this}for(var R in S){H.Doc.jRemoveEvent.call(this,R)}H.Doc.jDel.call(this,"_EVENTS_");return this}});(function(R){if("complete"===document.readyState){return R.jBrowser.onready.jDelay(1)}if(R.jBrowser.webkit&&R.jBrowser.version<420){(function(){(R.$(["loaded","complete"]).contains(document.readyState))?R.jBrowser.onready():arguments.callee.jDelay(50)})()}else{if(R.jBrowser.trident&&R.jBrowser.ieMode<9&&window==top){(function(){(R.$try(function(){R.jBrowser.getDoc().doScroll("left");return true}))?R.jBrowser.onready():arguments.callee.jDelay(50)})()}else{R.Doc.jAddEvent.call(R.$(document),"DOMContentLoaded",R.jBrowser.onready);R.Doc.jAddEvent.call(R.$(window),"load",R.jBrowser.onready)}}})(N);H.Class=function(){var V=null,S=H.$A(arguments);if("class"==H.jTypeOf(S[0])){V=S.shift()}var R=function(){for(var Y in this){this[Y]=H.detach(this[Y])}if(this.constructor.$parent){this.$parent={};var aa=this.constructor.$parent;for(var Z in aa){var X=aa[Z];switch(H.jTypeOf(X)){case"function":this.$parent[Z]=H.Class.wrap(this,X);break;case"object":this.$parent[Z]=H.detach(X);break;case"array":this.$parent[Z]=H.detach(X);break}}}var W=(this.init)?this.init.apply(this,arguments):this;delete this.caller;return W};if(!R.prototype.init){R.prototype.init=H.$F}if(V){var U=function(){};U.prototype=V.prototype;R.prototype=new U;R.$parent={};for(var T in V.prototype){R.$parent[T]=V.prototype[T]}}else{R.$parent=null}R.constructor=H.Class;R.prototype.constructor=R;H.extend(R.prototype,S[0]);H.extend(R,{$J_TYPE:"class"});return R};N.Class.wrap=function(R,S){return function(){var U=this.caller;var T=S.apply(R,arguments);return T}};(function(U){var T=U.$;var R=5,S=300;U.Event.Custom.btnclick=new U.Class(U.extend(U.Event.Custom,{type:"btnclick",init:function(X,W){var V=W.jGetPageXY();this.x=V.x;this.y=V.y;this.clientX=W.clientX;this.clientY=W.clientY;this.timeStamp=W.timeStamp;this.button=W.getButton();this.target=X;this.pushToEvents(W)}}));U.Event.Custom.btnclick.handler={options:{threshold:S,button:1},add:function(V){this.jStore("event:btnclick:options",U.extend(U.detach(U.Event.Custom.btnclick.handler.options),V||{}));this.jAddEvent("mousedown",U.Event.Custom.btnclick.handler.handle,1);this.jAddEvent("mouseup",U.Event.Custom.btnclick.handler.handle,1);this.jAddEvent("click",U.Event.Custom.btnclick.handler.onclick,1);if(U.jBrowser.trident&&U.jBrowser.ieMode<9){this.jAddEvent("dblclick",U.Event.Custom.btnclick.handler.handle,1)}},jRemove:function(){this.jRemoveEvent("mousedown",U.Event.Custom.btnclick.handler.handle);this.jRemoveEvent("mouseup",U.Event.Custom.btnclick.handler.handle);this.jRemoveEvent("click",U.Event.Custom.btnclick.handler.onclick);if(U.jBrowser.trident&&U.jBrowser.ieMode<9){this.jRemoveEvent("dblclick",U.Event.Custom.btnclick.handler.handle)}},onclick:function(V){V.stopDefaults()},handle:function(Y){var X,V,W;V=this.jFetch("event:btnclick:options");if(Y.type!="dblclick"&&Y.getButton()!=V.button){return}if(this.jFetch("event:btnclick:ignore")){this.jDel("event:btnclick:ignore");return}if("mousedown"==Y.type){X=new U.Event.Custom.btnclick(this,Y);this.jStore("event:btnclick:btnclickEvent",X)}else{if("mouseup"==Y.type){X=this.jFetch("event:btnclick:btnclickEvent");if(!X){return}W=Y.jGetPageXY();this.jDel("event:btnclick:btnclickEvent");X.pushToEvents(Y);if(Y.timeStamp-X.timeStamp<=V.threshold&&Math.sqrt(Math.pow(W.x-X.x,2)+Math.pow(W.y-X.y,2))<=R){this.jCallEvent("btnclick",X)}document.jCallEvent("mouseup",Y)}else{if(Y.type=="dblclick"){X=new U.Event.Custom.btnclick(this,Y);this.jCallEvent("btnclick",X)}}}}}})(N);(function(S){var R=S.$;S.Event.Custom.mousedrag=new S.Class(S.extend(S.Event.Custom,{type:"mousedrag",state:"dragstart",dragged:false,init:function(W,V,U){var T=V.jGetPageXY();this.x=T.x;this.y=T.y;this.clientX=V.clientX;this.clientY=V.clientY;this.timeStamp=V.timeStamp;this.button=V.getButton();this.target=W;this.pushToEvents(V);this.state=U}}));S.Event.Custom.mousedrag.handler={add:function(){var U=S.Event.Custom.mousedrag.handler.handleMouseMove.jBindAsEvent(this),T=S.Event.Custom.mousedrag.handler.handleMouseUp.jBindAsEvent(this);this.jAddEvent("mousedown",S.Event.Custom.mousedrag.handler.handleMouseDown,1);this.jAddEvent("mouseup",S.Event.Custom.mousedrag.handler.handleMouseUp,1);document.jAddEvent("mousemove",U,1);document.jAddEvent("mouseup",T,1);this.jStore("event:mousedrag:listeners:document:move",U);this.jStore("event:mousedrag:listeners:document:end",T)},jRemove:function(){this.jRemoveEvent("mousedown",S.Event.Custom.mousedrag.handler.handleMouseDown);this.jRemoveEvent("mouseup",S.Event.Custom.mousedrag.handler.handleMouseUp);R(document).jRemoveEvent("mousemove",this.jFetch("event:mousedrag:listeners:document:move")||S.$F);R(document).jRemoveEvent("mouseup",this.jFetch("event:mousedrag:listeners:document:end")||S.$F);this.jDel("event:mousedrag:listeners:document:move");this.jDel("event:mousedrag:listeners:document:end")},handleMouseDown:function(U){var T;if(1!=U.getButton()){return}U.stopDefaults();T=new S.Event.Custom.mousedrag(this,U,"dragstart");this.jStore("event:mousedrag:dragstart",T)},handleMouseUp:function(U){var T;T=this.jFetch("event:mousedrag:dragstart");if(!T){return}U.stopDefaults();T=new S.Event.Custom.mousedrag(this,U,"dragend");this.jDel("event:mousedrag:dragstart");this.jCallEvent("mousedrag",T)},handleMouseMove:function(U){var T;T=this.jFetch("event:mousedrag:dragstart");if(!T){return}U.stopDefaults();if(!T.dragged){T.dragged=true;this.jCallEvent("mousedrag",T)}T=new S.Event.Custom.mousedrag(this,U,"dragmove");this.jCallEvent("mousedrag",T)}}})(N);(function(S){var R=S.$;S.Event.Custom.dblbtnclick=new S.Class(S.extend(S.Event.Custom,{type:"dblbtnclick",timedout:false,tm:null,init:function(V,U){var T=U.jGetPageXY();this.x=T.x;this.y=T.y;this.clientX=U.clientX;this.clientY=U.clientY;this.timeStamp=U.timeStamp;this.button=U.getButton();this.target=V;this.pushToEvents(U)}}));S.Event.Custom.dblbtnclick.handler={options:{threshold:200},add:function(T){this.jStore("event:dblbtnclick:options",S.extend(S.detach(S.Event.Custom.dblbtnclick.handler.options),T||{}));this.jAddEvent("btnclick",S.Event.Custom.dblbtnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("btnclick",S.Event.Custom.dblbtnclick.handler.handle)},handle:function(V){var U,T;U=this.jFetch("event:dblbtnclick:event");T=this.jFetch("event:dblbtnclick:options");if(!U){U=new S.Event.Custom.dblbtnclick(this,V);U.tm=setTimeout(function(){U.timedout=true;V.isQueueStopped=S.$false;this.jCallEvent("btnclick",V);this.jDel("event:dblbtnclick:event")}.jBind(this),T.threshold+10);this.jStore("event:dblbtnclick:event",U);V.stopQueue()}else{clearTimeout(U.tm);this.jDel("event:dblbtnclick:event");if(!U.timedout){U.pushToEvents(V);V.stopQueue().stop();this.jCallEvent("dblbtnclick",U)}else{}}}}})(N);(function(X){var W=X.$;function R(Y){return Y.pointerType?(("touch"===Y.pointerType||Y.MSPOINTER_TYPE_TOUCH===Y.pointerType)&&Y.isPrimary):1===Y.changedTouches.length&&(Y.targetTouches.length?Y.targetTouches[0].identifier==Y.changedTouches[0].identifier:true)}function T(Y){if(Y.pointerType){return("touch"===Y.pointerType||Y.MSPOINTER_TYPE_TOUCH===Y.pointerType)?Y.pointerId:null}else{return Y.changedTouches[0].identifier}}function U(Y){if(Y.pointerType){return("touch"===Y.pointerType||Y.MSPOINTER_TYPE_TOUCH===Y.pointerType)?Y:null}else{return Y.changedTouches[0]}}X.Event.Custom.tap=new X.Class(X.extend(X.Event.Custom,{type:"tap",id:null,init:function(Z,Y){var aa=U(Y);this.id=aa.pointerId||aa.identifier;this.x=aa.pageX;this.y=aa.pageY;this.pageX=aa.pageX;this.pageY=aa.pageY;this.clientX=aa.clientX;this.clientY=aa.clientY;this.timeStamp=Y.timeStamp;this.button=0;this.target=Z;this.pushToEvents(Y)}}));var S=10,V=200;X.Event.Custom.tap.handler={add:function(Y){this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],X.Event.Custom.tap.handler.onTouchStart,1);this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],X.Event.Custom.tap.handler.onTouchEnd,1);this.jAddEvent("click",X.Event.Custom.tap.handler.onClick,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],X.Event.Custom.tap.handler.onTouchStart);this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],X.Event.Custom.tap.handler.onTouchEnd);this.jRemoveEvent("click",X.Event.Custom.tap.handler.onClick)},onClick:function(Y){Y.stopDefaults()},onTouchStart:function(Y){if(!R(Y)){this.jDel("event:tap:event");return}this.jStore("event:tap:event",new X.Event.Custom.tap(this,Y));this.jStore("event:btnclick:ignore",true)},onTouchEnd:function(ab){var Z=X.now(),aa=this.jFetch("event:tap:event"),Y=this.jFetch("event:tap:options");if(!aa||!R(ab)){return}this.jDel("event:tap:event");if(aa.id==T(ab)&&ab.timeStamp-aa.timeStamp<=V&&Math.sqrt(Math.pow(U(ab).pageX-aa.x,2)+Math.pow(U(ab).pageY-aa.y,2))<=S){this.jDel("event:btnclick:btnclickEvent");ab.stop();aa.pushToEvents(ab);this.jCallEvent("tap",aa)}}}})(N);H.Event.Custom.dbltap=new H.Class(H.extend(H.Event.Custom,{type:"dbltap",timedout:false,tm:null,init:function(S,R){this.x=R.x;this.y=R.y;this.clientX=R.clientX;this.clientY=R.clientY;this.timeStamp=R.timeStamp;this.button=0;this.target=S;this.pushToEvents(R)}}));H.Event.Custom.dbltap.handler={options:{threshold:300},add:function(R){this.jStore("event:dbltap:options",H.extend(H.detach(H.Event.Custom.dbltap.handler.options),R||{}));this.jAddEvent("tap",H.Event.Custom.dbltap.handler.handle,1)},jRemove:function(){this.jRemoveEvent("tap",H.Event.Custom.dbltap.handler.handle)},handle:function(T){var S,R;S=this.jFetch("event:dbltap:event");R=this.jFetch("event:dbltap:options");if(!S){S=new H.Event.Custom.dbltap(this,T);S.tm=setTimeout(function(){S.timedout=true;T.isQueueStopped=H.$false;this.jCallEvent("tap",T)}.jBind(this),R.threshold+10);this.jStore("event:dbltap:event",S);T.stopQueue()}else{clearTimeout(S.tm);this.jDel("event:dbltap:event");if(!S.timedout){S.pushToEvents(T);T.stopQueue().stop();this.jCallEvent("dbltap",S)}else{}}}};(function(W){var V=W.$;function R(X){return X.pointerType?(("touch"===X.pointerType||X.MSPOINTER_TYPE_TOUCH===X.pointerType)&&X.isPrimary):1===X.changedTouches.length&&(X.targetTouches.length?X.targetTouches[0].identifier==X.changedTouches[0].identifier:true)}function T(X){if(X.pointerType){return("touch"===X.pointerType||X.MSPOINTER_TYPE_TOUCH===X.pointerType)?X.pointerId:null}else{return X.changedTouches[0].identifier}}function U(X){if(X.pointerType){return("touch"===X.pointerType||X.MSPOINTER_TYPE_TOUCH===X.pointerType)?X:null}else{return X.changedTouches[0]}}var S=10;W.Event.Custom.touchdrag=new W.Class(W.extend(W.Event.Custom,{type:"touchdrag",state:"dragstart",id:null,dragged:false,init:function(Z,Y,X){var aa=U(Y);this.id=aa.pointerId||aa.identifier;this.clientX=aa.clientX;this.clientY=aa.clientY;this.pageX=aa.pageX;this.pageY=aa.pageY;this.x=aa.pageX;this.y=aa.pageY;this.timeStamp=Y.timeStamp;this.button=0;this.target=Z;this.pushToEvents(Y);this.state=X}}));W.Event.Custom.touchdrag.handler={add:function(){var Y=W.Event.Custom.touchdrag.handler.onTouchMove.jBind(this),X=W.Event.Custom.touchdrag.handler.onTouchEnd.jBind(this);this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],W.Event.Custom.touchdrag.handler.onTouchStart,1);this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],W.Event.Custom.touchdrag.handler.onTouchEnd,1);this.jAddEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],W.Event.Custom.touchdrag.handler.onTouchMove,1);this.jStore("event:touchdrag:listeners:document:move",Y);this.jStore("event:touchdrag:listeners:document:end",X);V(document).jAddEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",Y,1);V(document).jAddEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",X,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],W.Event.Custom.touchdrag.handler.onTouchStart);this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],W.Event.Custom.touchdrag.handler.onTouchEnd);this.jRemoveEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],W.Event.Custom.touchdrag.handler.onTouchMove);V(document).jRemoveEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",this.jFetch("event:touchdrag:listeners:document:move")||W.$F,1);V(document).jRemoveEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",this.jFetch("event:touchdrag:listeners:document:end")||W.$F,1);this.jDel("event:touchdrag:listeners:document:move");this.jDel("event:touchdrag:listeners:document:end")},onTouchStart:function(Y){var X;if(!R(Y)){return}X=new W.Event.Custom.touchdrag(this,Y,"dragstart");this.jStore("event:touchdrag:dragstart",X)},onTouchEnd:function(Y){var X;X=this.jFetch("event:touchdrag:dragstart");if(!X||!X.dragged||X.id!=T(Y)){return}X=new W.Event.Custom.touchdrag(this,Y,"dragend");this.jDel("event:touchdrag:dragstart");this.jCallEvent("touchdrag",X)},onTouchMove:function(Y){var X;X=this.jFetch("event:touchdrag:dragstart");if(!X||!R(Y)){return}if(X.id!=T(Y)){this.jDel("event:touchdrag:dragstart");return}if(!X.dragged&&Math.sqrt(Math.pow(U(Y).pageX-X.x,2)+Math.pow(U(Y).pageY-X.y,2))>S){X.dragged=true;this.jCallEvent("touchdrag",X)}if(!X.dragged){return}X=new W.Event.Custom.touchdrag(this,Y,"dragmove");this.jCallEvent("touchdrag",X)}}})(N);H.Event.Custom.touchpinch=new H.Class(H.extend(H.Event.Custom,{type:"touchpinch",scale:1,previousScale:1,curScale:1,state:"pinchstart",init:function(S,R){this.timeStamp=R.timeStamp;this.button=0;this.target=S;this.x=R.touches[0].clientX+(R.touches[1].clientX-R.touches[0].clientX)/2;this.y=R.touches[0].clientY+(R.touches[1].clientY-R.touches[0].clientY)/2;this._initialDistance=Math.sqrt(Math.pow(R.touches[0].clientX-R.touches[1].clientX,2)+Math.pow(R.touches[0].clientY-R.touches[1].clientY,2));this.pushToEvents(R)},update:function(R){var S;this.state="pinchupdate";if(R.changedTouches[0].identifier!=this.events[0].touches[0].identifier||R.changedTouches[1].identifier!=this.events[0].touches[1].identifier){return}S=Math.sqrt(Math.pow(R.changedTouches[0].clientX-R.changedTouches[1].clientX,2)+Math.pow(R.changedTouches[0].clientY-R.changedTouches[1].clientY,2));this.previousScale=this.scale;this.scale=S/this._initialDistance;this.curScale=this.scale/this.previousScale;this.x=R.changedTouches[0].clientX+(R.changedTouches[1].clientX-R.changedTouches[0].clientX)/2;this.y=R.changedTouches[0].clientY+(R.changedTouches[1].clientY-R.changedTouches[0].clientY)/2;this.pushToEvents(R)}}));H.Event.Custom.touchpinch.handler={add:function(){this.jAddEvent("touchstart",H.Event.Custom.touchpinch.handler.handleTouchStart,1);this.jAddEvent("touchend",H.Event.Custom.touchpinch.handler.handleTouchEnd,1);this.jAddEvent("touchmove",H.Event.Custom.touchpinch.handler.handleTouchMove,1)},jRemove:function(){this.jRemoveEvent("touchstart",H.Event.Custom.touchpinch.handler.handleTouchStart);this.jRemoveEvent("touchend",H.Event.Custom.touchpinch.handler.handleTouchEnd);this.jRemoveEvent("touchmove",H.Event.Custom.touchpinch.handler.handleTouchMove)},handleTouchStart:function(S){var R;if(S.touches.length!=2){return}S.stopDefaults();R=new H.Event.Custom.touchpinch(this,S);this.jStore("event:touchpinch:event",R)},handleTouchEnd:function(S){var R;R=this.jFetch("event:touchpinch:event");if(!R){return}S.stopDefaults();this.jDel("event:touchpinch:event")},handleTouchMove:function(S){var R;R=this.jFetch("event:touchpinch:event");if(!R){return}S.stopDefaults();R.update(S);this.jCallEvent("touchpinch",R)}};(function(W){var U=W.$;W.Event.Custom.mousescroll=new W.Class(W.extend(W.Event.Custom,{type:"mousescroll",init:function(ac,ab,ae,Y,X,ad,Z){var aa=ab.jGetPageXY();this.x=aa.x;this.y=aa.y;this.timeStamp=ab.timeStamp;this.target=ac;this.delta=ae||0;this.deltaX=Y||0;this.deltaY=X||0;this.deltaZ=ad||0;this.deltaFactor=Z||0;this.deltaMode=ab.deltaMode||0;this.isMouse=false;this.pushToEvents(ab)}}));var V,S;function R(){V=null}function T(X,Y){return(X>50)||(1===Y&&!("win"==W.jBrowser.platform&&X<1))||(0===X%12)||(0==X%4.000244140625)}W.Event.Custom.mousescroll.handler={eventType:"onwheel"in document||W.jBrowser.ieMode>8?"wheel":"mousewheel",add:function(){this.jAddEvent(W.Event.Custom.mousescroll.handler.eventType,W.Event.Custom.mousescroll.handler.handle,1)},jRemove:function(){this.jRemoveEvent(W.Event.Custom.mousescroll.handler.eventType,W.Event.Custom.mousescroll.handler.handle,1)},handle:function(ac){var ad=0,aa=0,Y=0,X=0,ab,Z;if(ac.detail){Y=ac.detail*-1}if(ac.wheelDelta!==undefined){Y=ac.wheelDelta}if(ac.wheelDeltaY!==undefined){Y=ac.wheelDeltaY}if(ac.wheelDeltaX!==undefined){aa=ac.wheelDeltaX*-1}if(ac.deltaY){Y=-1*ac.deltaY}if(ac.deltaX){aa=ac.deltaX}if(0===Y&&0===aa){return}ad=0===Y?aa:Y;X=Math.max(Math.abs(Y),Math.abs(aa));if(!V||X<V){V=X}ab=ad>0?"floor":"ceil";ad=Math[ab](ad/V);aa=Math[ab](aa/V);Y=Math[ab](Y/V);if(S){clearTimeout(S)}S=setTimeout(R,200);Z=new W.Event.Custom.mousescroll(this,ac,ad,aa,Y,0,V);Z.isMouse=T(V,ac.deltaMode||0);this.jCallEvent("mousescroll",Z)}}})(N);H.win=H.$(window);H.doc=H.$(document);return N})();(function(D){if(!D){throw"MagicJS not found"}var C=D.$;var B=window.URL||window.webkitURL||null;p.ImageLoader=new D.Class({img:null,ready:false,options:{onprogress:D.$F,onload:D.$F,onabort:D.$F,onerror:D.$F,oncomplete:D.$F,onxhrerror:D.$F,xhr:false,progressiveLoad:true},size:null,_timer:null,loadedBytes:0,_handlers:{onprogress:function(E){if(E.target&&(200===E.target.status||304===E.target.status)&&E.lengthComputable){this.options.onprogress.jBind(null,(E.loaded-(this.options.progressiveLoad?this.loadedBytes:0))/E.total).jDelay(1);this.loadedBytes=E.loaded}},onload:function(E){if(E){C(E).stop()}this._unbind();if(this.ready){return}this.ready=true;this._cleanup();!this.options.xhr&&this.options.onprogress.jBind(null,1).jDelay(1);this.options.onload.jBind(null,this).jDelay(1);this.options.oncomplete.jBind(null,this).jDelay(1)},onabort:function(E){if(E){C(E).stop()}this._unbind();this.ready=false;this._cleanup();this.options.onabort.jBind(null,this).jDelay(1);this.options.oncomplete.jBind(null,this).jDelay(1)},onerror:function(E){if(E){C(E).stop()}this._unbind();this.ready=false;this._cleanup();this.options.onerror.jBind(null,this).jDelay(1);this.options.oncomplete.jBind(null,this).jDelay(1)}},_bind:function(){C(["load","abort","error"]).jEach(function(E){this.img.jAddEvent(E,this._handlers["on"+E].jBindAsEvent(this).jDefer(1))},this)},_unbind:function(){if(this._timer){try{clearTimeout(this._timer)}catch(E){}this._timer=null}C(["load","abort","error"]).jEach(function(F){this.img.jRemoveEvent(F)},this)},_cleanup:function(){this.jGetSize();if(this.img.jFetch("new")){var E=this.img.parentNode;this.img.jRemove().jDel("new").jSetCss({position:"static",top:"auto"});E.kill()}},loadBlob:function(F){var G=new XMLHttpRequest(),E;C(["abort","progress"]).jEach(function(H){G["on"+H]=C(function(I){this._handlers["on"+H].call(this,I)}).jBind(this)},this);G.onerror=C(function(){this.options.onxhrerror.jBind(null,this).jDelay(1);this.options.xhr=false;this._bind();this.img.src=F}).jBind(this);G.onload=C(function(){if(200!==G.status&&304!==G.status){this._handlers.onerror.call(this);return}E=G.response;this._bind();if(B&&!D.jBrowser.trident&&!("ios"===D.jBrowser.platform&&D.jBrowser.version<537)){this.img.setAttribute("src",B.createObjectURL(E))}else{this.img.src=F}}).jBind(this);G.open("GET",F);G.responseType="blob";G.send()},init:function(F,E){this.options=D.extend(this.options,E);this.img=C(F)||D.$new("img",{},{"max-width":"none","max-height":"none"}).jAppendTo(D.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-10000,width:10,height:10,overflow:"hidden"}).jAppendTo(document.body)).jStore("new",true);if(D.jBrowser.features.xhr2&&this.options.xhr&&"string"==D.jTypeOf(F)){this.loadBlob(F);return}var G=function(){if(this.isReady()){this._handlers.onload.call(this)}else{this._handlers.onerror.call(this)}G=null}.jBind(this);this._bind();if("string"==D.jTypeOf(F)){this.img.src=F}else{if(D.jBrowser.trident&&5==D.jBrowser.version&&D.jBrowser.ieMode<9){this.img.onreadystatechange=function(){if(/loaded|complete/.test(this.img.readyState)){this.img.onreadystatechange=null;G&&G()}}.jBind(this)}this.img.src=F.getAttribute("src")}this.img&&this.img.complete&&G&&(this._timer=G.jDelay(100))},destroy:function(){this._unbind();this._cleanup();this.ready=false;return this},isReady:function(){var E=this.img;return(E.naturalWidth)?(E.naturalWidth>0):(E.readyState)?("complete"==E.readyState):E.width>0},jGetSize:function(){return this.size||(this.size={width:this.img.naturalWidth||this.img.width,height:this.img.naturalHeight||this.img.height})}})})(p);(function(C){if(!C){throw"MagicJS not found"}if(C.FX){return}var B=C.$;C.FX=new C.Class({init:function(E,D){var F;this.el=C.$(E);this.options=C.extend(this.options,D);this.timer=false;this.easeFn=this.cubicBezierAtTime;F=C.FX.Transition[this.options.transition]||this.options.transition;if("function"===C.jTypeOf(F)){this.easeFn=F}else{this.cubicBezier=this.parseCubicBezier(F)||this.parseCubicBezier("ease")}if("string"==C.jTypeOf(this.options.cycles)){this.options.cycles="infinite"===this.options.cycles?Infinity:parseInt(this.options.cycles)||1}},options:{fps:60,duration:600,transition:"ease",cycles:1,direction:"normal",onStart:C.$F,onComplete:C.$F,onBeforeRender:C.$F,onAfterRender:C.$F,forceAnimation:false,roundCss:false},styles:null,cubicBezier:null,easeFn:null,setTransition:function(D){this.options.transition=D;D=C.FX.Transition[this.options.transition]||this.options.transition;if("function"===C.jTypeOf(D)){this.easeFn=D}else{this.easeFn=this.cubicBezierAtTime;this.cubicBezier=this.parseCubicBezier(D)||this.parseCubicBezier("ease")}},start:function(F){var D=/\%$/,E;this.styles=F;this.cycle=0;this.state=0;this.curFrame=0;this.pStyles={};this.alternate="alternate"===this.options.direction||"alternate-reverse"===this.options.direction;this.continuous="continuous"===this.options.direction||"continuous-reverse"===this.options.direction;for(E in this.styles){D.test(this.styles[E][0])&&(this.pStyles[E]=true);if("reverse"===this.options.direction||"alternate-reverse"===this.options.direction||"continuous-reverse"===this.options.direction){this.styles[E].reverse()}}this.startTime=C.now();this.finishTime=this.startTime+this.options.duration;this.options.onStart.call();if(0===this.options.duration){this.render(1);this.options.onComplete.call()}else{this.loopBind=this.loop.jBind(this);if(!this.options.forceAnimation&&C.jBrowser.features.requestAnimationFrame){this.timer=C.jBrowser.requestAnimationFrame.call(window,this.loopBind)}else{this.timer=this.loopBind.interval(Math.round(1000/this.options.fps))}}return this},stopAnimation:function(){if(this.timer){if(!this.options.forceAnimation&&C.jBrowser.features.requestAnimationFrame&&C.jBrowser.cancelAnimationFrame){C.jBrowser.cancelAnimationFrame.call(window,this.timer)}else{clearInterval(this.timer)}this.timer=false}},stop:function(D){D=C.defined(D)?D:false;this.stopAnimation();if(D){this.render(1);this.options.onComplete.jDelay(10)}return this},calc:function(F,E,D){F=parseFloat(F);E=parseFloat(E);return(E-F)*D+F},loop:function(){var E=C.now(),D=(E-this.startTime)/this.options.duration,F=Math.floor(D);if(E>=this.finishTime&&F>=this.options.cycles){this.stopAnimation();this.render(1);this.options.onComplete.jDelay(10);return this}if(this.alternate&&this.cycle<F){for(var G in this.styles){this.styles[G].reverse()}}this.cycle=F;if(!this.options.forceAnimation&&C.jBrowser.features.requestAnimationFrame){this.timer=C.jBrowser.requestAnimationFrame.call(window,this.loopBind)}this.render((this.continuous?F:0)+this.easeFn(D%1))},render:function(D){var E={},G=D;for(var F in this.styles){if("opacity"===F){E[F]=Math.round(this.calc(this.styles[F][0],this.styles[F][1],D)*100)/100}else{E[F]=this.calc(this.styles[F][0],this.styles[F][1],D);this.pStyles[F]&&(E[F]+="%")}}this.options.onBeforeRender(E,this.el);this.set(E);this.options.onAfterRender(E,this.el)},set:function(D){return this.el.jSetCss(D)},parseCubicBezier:function(D){var E,F=null;if("string"!==C.jTypeOf(D)){return null}switch(D){case"linear":F=B([0,0,1,1]);break;case"ease":F=B([0.25,0.1,0.25,1]);break;case"ease-in":F=B([0.42,0,1,1]);break;case"ease-out":F=B([0,0,0.58,1]);break;case"ease-in-out":F=B([0.42,0,0.58,1]);break;case"easeInSine":F=B([0.47,0,0.745,0.715]);break;case"easeOutSine":F=B([0.39,0.575,0.565,1]);break;case"easeInOutSine":F=B([0.445,0.05,0.55,0.95]);break;case"easeInQuad":F=B([0.55,0.085,0.68,0.53]);break;case"easeOutQuad":F=B([0.25,0.46,0.45,0.94]);break;case"easeInOutQuad":F=B([0.455,0.03,0.515,0.955]);break;case"easeInCubic":F=B([0.55,0.055,0.675,0.19]);break;case"easeOutCubic":F=B([0.215,0.61,0.355,1]);break;case"easeInOutCubic":F=B([0.645,0.045,0.355,1]);break;case"easeInQuart":F=B([0.895,0.03,0.685,0.22]);break;case"easeOutQuart":F=B([0.165,0.84,0.44,1]);break;case"easeInOutQuart":F=B([0.77,0,0.175,1]);break;case"easeInQuint":F=B([0.755,0.05,0.855,0.06]);break;case"easeOutQuint":F=B([0.23,1,0.32,1]);break;case"easeInOutQuint":F=B([0.86,0,0.07,1]);break;case"easeInExpo":F=B([0.95,0.05,0.795,0.035]);break;case"easeOutExpo":F=B([0.19,1,0.22,1]);break;case"easeInOutExpo":F=B([1,0,0,1]);break;case"easeInCirc":F=B([0.6,0.04,0.98,0.335]);break;case"easeOutCirc":F=B([0.075,0.82,0.165,1]);break;case"easeInOutCirc":F=B([0.785,0.135,0.15,0.86]);break;case"easeInBack":F=B([0.6,-0.28,0.735,0.045]);break;case"easeOutBack":F=B([0.175,0.885,0.32,1.275]);break;case"easeInOutBack":F=B([0.68,-0.55,0.265,1.55]);break;default:D=D.replace(/\s/g,"");if(D.match(/^cubic-bezier\((?:-?[0-9\.]{0,}[0-9]{1,},){3}(?:-?[0-9\.]{0,}[0-9]{1,})\)$/)){F=D.replace(/^cubic-bezier\s*\(|\)$/g,"").split(",");for(E=F.length-1;E>=0;E--){F[E]=parseFloat(F[E])}}}return B(F)},cubicBezierAtTime:function(P){var D=0,O=0,L=0,Q=0,N=0,J=0,K=this.options.duration;function I(R){return((D*R+O)*R+L)*R}function H(R){return((Q*R+N)*R+J)*R}function F(R){return(3*D*R+2*O)*R+L}function M(R){return 1/(200*R)}function E(R,S){return H(G(R,S))}function G(Y,Z){var X,W,V,S,R,U;function T(aa){if(aa>=0){return aa}else{return 0-aa}}for(V=Y,U=0;U<8;U++){S=I(V)-Y;if(T(S)<Z){return V}R=F(V);if(T(R)<0.000001){break}V=V-S/R}X=0;W=1;V=Y;if(V<X){return X}if(V>W){return W}while(X<W){S=I(V);if(T(S-Y)<Z){return V}if(Y>S){X=V}else{W=V}V=(W-X)*0.5+X}return V}L=3*this.cubicBezier[0];O=3*(this.cubicBezier[2]-this.cubicBezier[0])-L;D=1-L-O;J=3*this.cubicBezier[1];N=3*(this.cubicBezier[3]-this.cubicBezier[1])-J;Q=1-J-N;return E(P,M(K))}});C.FX.Transition={linear:"linear",sineIn:"easeInSine",sineOut:"easeOutSine",expoIn:"easeInExpo",expoOut:"easeOutExpo",quadIn:"easeInQuad",quadOut:"easeOutQuad",cubicIn:"easeInCubic",cubicOut:"easeOutCubic",backIn:"easeInBack",backOut:"easeOutBack",elasticIn:function(E,D){D=D||[];return Math.pow(2,10*--E)*Math.cos(20*E*Math.PI*(D[0]||1)/3)},elasticOut:function(E,D){return 1-C.FX.Transition.elasticIn(1-E,D)},bounceIn:function(F){for(var E=0,D=1;1;E+=D,D/=2){if(F>=(7-4*E)/11){return D*D-Math.pow((11-6*E-11*F)/4,2)}}},bounceOut:function(D){return 1-C.FX.Transition.bounceIn(1-D)},none:function(D){return 0}}})(p);(function(C){if(!C){throw"MagicJS not found"}if(C.PFX){return}var B=C.$;C.PFX=new C.Class(C.FX,{init:function(D,E){this.el_arr=D;this.options=C.extend(this.options,E);this.timer=false;this.$parent.init()},start:function(H){var D=/\%$/,G,F,E=H.length;this.styles_arr=H;this.pStyles_arr=new Array(E);for(F=0;F<E;F++){this.pStyles_arr[F]={};for(G in H[F]){D.test(H[F][G][0])&&(this.pStyles_arr[F][G]=true);if("reverse"===this.options.direction||"alternate-reverse"===this.options.direction||"continuous-reverse"===this.options.direction){this.styles_arr[F][G].reverse()}}}this.$parent.start([]);return this},render:function(D){for(var E=0;E<this.el_arr.length;E++){this.el=C.$(this.el_arr[E]);this.styles=this.styles_arr[E];this.pStyles=this.pStyles_arr[E];this.$parent.render(D)}}})})(p);(function(C){if(!C){throw"MagicJS not found";return}if(C.Tooltip){return}var B=C.$;C.Tooltip=function(E,F){var D=this.tooltip=C.$new("div",null,{position:"absolute","z-index":999}).jAddClass("MagicToolboxTooltip");C.$(E).jAddEvent("mouseover",function(){D.jAppendTo(document.body)});C.$(E).jAddEvent("mouseout",function(){D.jRemove()});C.$(E).jAddEvent("mousemove",function(K){var M=20,J=C.$(K).jGetPageXY(),I=D.jGetSize(),H=C.$(window).jGetSize(),L=C.$(window).jGetScroll();function G(P,N,O){return(O<(P-N)/2)?O:((O>(P+N)/2)?(O-N):(P-N)/2)}D.jSetCss({left:L.x+G(H.width,I.width+2*M,J.x-L.x)+M,top:L.y+G(H.height,I.height+2*M,J.y-L.y)+M})});this.text(F)};C.Tooltip.prototype.text=function(D){this.tooltip.firstChild&&this.tooltip.removeChild(this.tooltip.firstChild);this.tooltip.append(document.createTextNode(D))}})(p);(function(C){if(!C){throw"MagicJS not found";return}if(C.MessageBox){return}var B=C.$;C.Message=function(G,F,E,D){this.hideTimer=null;this.messageBox=C.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden",opacity:0.8}).jAddClass(D||"").jAppendTo(E||document.body);this.setMessage(G);this.show(F)};C.Message.prototype.show=function(D){this.messageBox.show();this.hideTimer=this.hide.jBind(this).jDelay(C.ifndef(D,5000))};C.Message.prototype.hide=function(D){clearTimeout(this.hideTimer);this.hideTimer=null;if(this.messageBox&&!this.hideFX){this.hideFX=new p.FX(this.messageBox,{duration:C.ifndef(D,500),onComplete:function(){this.messageBox.kill();delete this.messageBox;this.hideFX=null}.jBind(this)}).start({opacity:[this.messageBox.jGetCss("opacity"),0]})}};C.Message.prototype.setMessage=function(D){this.messageBox.firstChild&&this.tooltip.removeChild(this.messageBox.firstChild);this.messageBox.append(document.createTextNode(D))}})(p);(function(C){if(!C){throw"MagicJS not found"}if(C.Options){return}var F=C.$,B=null,J={"boolean":1,array:2,number:3,"function":4,string:100},D={"boolean":function(M,L,K){if("boolean"!=C.jTypeOf(L)){if(K||"string"!=C.jTypeOf(L)){return false}else{if(!/^(true|false)$/.test(L)){return false}else{L=L.jToBool()}}}if(M.hasOwnProperty("enum")&&!F(M["enum"]).contains(L)){return false}B=L;return true},string:function(M,L,K){if("string"!==C.jTypeOf(L)){return false}else{if(M.hasOwnProperty("enum")&&!F(M["enum"]).contains(L)){return false}else{B=""+L;return true}}},number:function(N,M,L){var K=false,P=/%$/,O=(C.jTypeOf(M)=="string"&&P.test(M));if(L&&!"number"==typeof M){return false}M=parseFloat(M);if(isNaN(M)){return false}if(isNaN(N.minimum)){N.minimum=Number.NEGATIVE_INFINITY}if(isNaN(N.maximum)){N.maximum=Number.POSITIVE_INFINITY}if(N.hasOwnProperty("enum")&&!F(N["enum"]).contains(M)){return false}if(N.minimum>M||M>N.maximum){return false}B=O?(M+"%"):M;return true},array:function(N,L,K){if("string"===C.jTypeOf(L)){try{L=window.JSON.parse(L)}catch(M){return false}}if(C.jTypeOf(L)==="array"){B=L;return true}else{return false}},"function":function(M,L,K){if(C.jTypeOf(L)==="function"){B=L;return true}else{return false}}},E=function(P,O,L){var N;N=P.hasOwnProperty("oneOf")?P.oneOf:[P];if("array"!=C.jTypeOf(N)){return false}for(var M=0,K=N.length-1;M<=K;M++){if(D[N[M].type](N[M],O,L)){return true}}return false},H=function(P){var N,M,O,K,L;if(P.hasOwnProperty("oneOf")){K=P.oneOf.length;for(N=0;N<K;N++){for(M=N+1;M<K;M++){if(J[P.oneOf[N]["type"]]>J[P.oneOf[M].type]){L=P.oneOf[N];P.oneOf[N]=P.oneOf[M];P.oneOf[M]=L}}}}return P},I=function(N){var M;M=N.hasOwnProperty("oneOf")?N.oneOf:[N];if("array"!=C.jTypeOf(M)){return false}for(var L=M.length-1;L>=0;L--){if(!M[L].type||!J.hasOwnProperty(M[L].type)){return false}if(C.defined(M[L]["enum"])){if("array"!==C.jTypeOf(M[L]["enum"])){return false}for(var K=M[L]["enum"].length-1;K>=0;K--){if(!D[M[L].type]({type:M[L].type},M[L]["enum"][K],true)){return false}}}}if(N.hasOwnProperty("default")&&!E(N,N["default"],true)){return false}return true},G=function(K){this.schema={};this.options={};this.parseSchema(K)};C.extend(G.prototype,{parseSchema:function(M){var L,K,N;for(L in M){if(!M.hasOwnProperty(L)){continue}K=(L+"").jTrim().jCamelize();if(!this.schema.hasOwnProperty(K)){this.schema[K]=H(M[L]);if(!I(this.schema[K])){throw"Incorrect definition of the '"+L+"' parameter in "+M}this.options[K]=undefined}}},set:function(L,K){L=(L+"").jTrim().jCamelize();if(C.jTypeOf(K)=="string"){K=K.jTrim()}if(this.schema.hasOwnProperty(L)){B=K;if(E(this.schema[L],K)){this.options[L]=B}B=null}},get:function(K){K=(K+"").jTrim().jCamelize();if(this.schema.hasOwnProperty(K)){return C.defined(this.options[K])?this.options[K]:this.schema[K]["default"]}},fromJSON:function(L){for(var K in L){this.set(K,L[K])}},getJSON:function(){var L=C.extend({},this.options);for(var K in L){if(undefined===L[K]&&undefined!==this.schema[K]["default"]){L[K]=this.schema[K]["default"]}}return L},fromString:function(K){F(K.split(";")).jEach(F(function(L){L=L.split(":");this.set(L.shift().jTrim(),L.join(":"))}).jBind(this))},exists:function(K){K=(K+"").jTrim().jCamelize();return this.schema.hasOwnProperty(K)},isset:function(K){K=(K+"").jTrim().jCamelize();return this.exists(K)&&C.defined(this.options[K])},jRemove:function(K){K=(K+"").jTrim().jCamelize();if(this.exists(K)){delete this.options[K];delete this.schema[K]}}});C.Options=G}(p));q.$AA=function(B){var D=[],C;for(C in B){if(!B.hasOwnProperty(C)||(C+"").substring(0,2)=="$J"){continue}D.push(B[C])}return q.$A(D)};q.nativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:1,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1};q.customEventsAllowed={document:true,element:true,"class":true,object:true};q.customEvents={bindEvent:function(F,E,C){if(q.jTypeOf(F)=="array"){j(F).jEach(this.bindEvent.jBindAsEvent(this,E,C));return this}if(!F||!E||q.jTypeOf(F)!="string"||q.jTypeOf(E)!="function"){return this}if(F=="domready"&&q.jBrowser.ready){E.call(this);return this}C=parseInt(C||10);if(!E.$J_EUID){E.$J_EUID=Math.floor(Math.random()*q.now())}var D=this.jFetch("_events",{});D[F]||(D[F]={});D[F][C]||(D[F][C]={});D[F]["orders"]||(D[F]["orders"]={});if(D[F][C][E.$J_EUID]){return this}if(D[F]["orders"][E.$J_EUID]){this.unbindEvent(F,E)}var B=this,G=function(H){return E.call(B,j(H))};if(q.nativeEvents[F]&&!D[F]["function"]){if(q.nativeEvents[F]==2){G=function(H){H=q.extend(H||window.e,{$J_TYPE:"event"});return E.call(B,j(H))}}D[F]["function"]=function(H){B.jCallEvent(F,H)};this[q._event_add_](q._event_prefix_+F,D[F]["function"],false)}D[F][C][E.$J_EUID]=G;D[F]["orders"][E.$J_EUID]=C;return this},jCallEvent:function(C,E){try{E=q.extend(E||{},{type:C})}catch(D){}if(!C||q.jTypeOf(C)!="string"){return this}var B=this.jFetch("_events",{});B[C]||(B[C]={});B[C]["orders"]||(B[C]["orders"]={});q.$AA(B[C]).jEach(function(F){if(F!=B[C]["orders"]&&F!=B[C]["function"]){q.$AA(F).jEach(function(G){G(this)},this)}},E);return this},unbindEvent:function(E,D){if(!E||!D||q.jTypeOf(E)!="string"||q.jTypeOf(D)!="function"){return this}if(!D.$J_EUID){D.$J_EUID=Math.floor(Math.random()*q.now())}var C=this.jFetch("_events",{});C[E]||(C[E]={});C[E]["orders"]||(C[E]["orders"]={});order=C[E]["orders"][D.$J_EUID];C[E][order]||(C[E][order]={});if(order>=0&&C[E][order][D.$J_EUID]){delete C[E][order][D.$J_EUID];delete C[E]["orders"][D.$J_EUID];if(q.$AA(C[E][order]).length==0){delete C[E][order];if(q.nativeEvents[E]&&q.$AA(C[E]).length==0){var B=this;this[q._event_del_](q._event_prefix_+E,C[E]["function"],false)}}}return this},destroyEvent:function(D){if(!D||q.jTypeOf(D)!="string"){return this}var C=this.jFetch("_events",{});if(q.nativeEvents[D]){var B=this;this[q._event_del_](q._event_prefix_+D,C[D]["function"],false)}C[D]={};return this},cloneEvents:function(D,C){var B=this.jFetch("_events",{});for(t in B){if(C&&t!=C){continue}for(order in B[t]){if(order=="orders"||order=="function"){continue}for(f in B[t][order]){j(D).bindEvent(t,B[t][order][f],order)}}}return this},jCopyEvents:function(E,D){if(1!==E.nodeType){return this}var C=this.jFetch("events");if(!C){return this}for(var B in C){if(D&&B!=D){continue}for(var F in C[B]){j(E).bindEvent(B,C[B][F])}}return this},jFetch:q.Element.jFetch,jStore:q.Element.jStore};(function(B){if(!B){throw"MagicJS not found";return}B.extend=function(J,I){if(!(J instanceof window.Array)){J=[J]}if(!(I instanceof window.Array)){I=[I]}for(var G=0,D=J.length;G<D;G++){if(!B.defined(J[G])){continue}for(var F=0,H=I.length;F<H;F++){if(!B.defined(I[F])){continue}for(var E in(I[F]||{})){try{J[G][E]=I[F][E]}catch(C){}}}}return J[0]};B.inherit=function(E,D){function C(){}C.prototype=D.prototype;E.$parent=D.prototype;E.prototype=new C();E.prototype.constructor=E};B.extend([B.Element,window.magicJS.Element],{jGetSize_:B.Element.jGetSize,jGetSize:function(C){var D=this.jGetSize_();if(C){D.width+=(parseInt(this.jGetCss("margin-left")||0)+parseInt(this.jGetCss("margin-right")||0));D.height+=(parseInt(this.jGetCss("margin-top")||0)+((this.jGetCss("display")!="block")?parseInt(this.jGetCss("margin-bottom")||0):0))}return D}})})(p);q.Modules||(q.Modules={});q.Modules.ArrowsPair=(function(){var B=["next","prev"],E;function F(H,G){return q.$new("button",null,{display:"inline-block"}).jAddClass(E["class"]).jAddClass(E.orientation).jAddClass(E["class"]+"-arrow").jAddClass(E["class"]+"-arrow-"+H).jAppendTo(G)}function C(G,H){H.stopDistribution();this.jCallEvent(G)}var D=function(H,G){q.$uuid(this);this.options={"class":"",classHidden:"",classDisabled:"",position:"inside",orientation:"ms-horizontal",form:"button"};E=this.o=this.options;q.extend(this.o,H);this.prev=F("prev",G);this.next=F("next",G);this.next.jAddEvent("click",function(I){I.stop()}).jAddEvent("btnclick tap",C.jBind(this,"forward"));this.prev.jAddEvent("click",function(I){I.stop()}).jAddEvent("btnclick tap",C.jBind(this,"backward"))};D.prototype={disable:function(G){i(G&&[G]||B).jEach(function(H){this[H].jAddClass(E.classDisabled)},this)},enable:function(G){i(G&&[G]||B).jEach(function(H){this[H].jRemoveClass(E.classDisabled)},this)},hide:function(G){i(G&&[G]||B).jEach(function(H){this[H].jAddClass(E.classHidden)},this)},show:function(G){i(G&&[G]||B).jEach(function(H){this[H].jRemoveClass(E.classHidden)},this)},jRemove:function(G){i(G&&[G]||B).jEach(function(H){this[H].kill()},this)},setOrientation:function(G){i(B).jEach(function(H){this[H].jRemoveClass("mcs-"+E.orientation);this[H].jAddClass("mcs-"+G)},this);this.o.orientation="mcs-"+G}};q.extend(D.prototype,q.customEvents);return D})();q.Modules||(q.Modules={});q.Modules.Bullets=(function(){var C="active",B=function(F,E,D){q.$uuid(this);this._options={};this.o=this._options;q.extend(this.o,F);this.bullets=q.$([]);this.callback=D;this.activeBullet={};this.ban=false;this.container=q.$new("div",{"class":"mcs-bullets"});this.container.jAppendTo(E)};B.prototype={push:function(D){var E=i(function(G){var F=this.bullets.length;this.bullets.push({index:F,enable:false,jump:G,node:q.$new("div",{"class":"mcs-bullet mcs-bullet-"+F})});if(!F){this.activeBullet=this.bullets[F];this.activate(this.bullets[F]);this.bullets[F].enable=true}this.bullets[F].node.jAddEvent("click",i(function(H){H.stop();if(this.bullets[F].index==this.activeBullet.index){return}this.ban=this.callback();!this.ban&&this.jCallEvent("bullets-click",{direction:this.getDirection(this.bullets[F]),jumpIndex:this.bullets[F].jump})}).jBind(this));this.bullets[F].node.jAppendTo(this.container)}).jBind(this);this.reset();D.jEach(i(function(F){E(F)}).jBind(this))},setActiveBullet:function(D,E){if(this.activeBullet.index==D[0]){return}this.activate(this.getBulletIndex(D,E))},show:function(){this.container.jAddClass("show")},update:function(){if(this.activeBullet.node){this.deactivate();this.activate(this.bullets[0])}},jRemove:function(){this.bullets.jEach(function(D){D.node.kill()});this.container.kill()},deactivate:function(){this.activeBullet.enable=false;this.activeBullet.node.jRemoveClass(C)},activate:function(D){this.deactivate();this.activeBullet=D;D.enable=true;D.node.jAddClass(C)},getDirection:function(D){var E=this.activeBullet.index>D.index?"backward":"forward";this.activate(D);return E},getBulletIndex:function(D,G){var H,F=this.bullets.length-1,E=this.activeBullet;for(var H=F;H>=0;H--){if(this.bullets[H].jump<=D[0]){E=this.bullets[H];break}}if(G){if(this.o.items-1==D[D.length-1]){E=this.bullets[F]}}return E},reset:function(){this.ban=false;this.activeBullet={};this.bullets.jEach(function(D){D.node.kill()});this.bullets.length=0}};q.extend(B.prototype,q.customEvents);return B})();q.Modules||(q.Modules={});q.Modules.Progress=(function(){var C=300,B=function(D,E){this.flag="none";this.node=q.$new("div",{"class":"mcs-loader"});if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.node.append(q.$new("div",{"class":"mcs-loader-text"}).append(q.doc.createTextNode("Loading...")))}else{if(E){this.node.append(q.$new("div",{"class":"mcs-loader-circles"}).append(q.$new("div",{"class":"mcs-item-loader"},{"z-index":100000})))}else{this.node.append(q.$new("div",{"class":"mcs-loader-circles"}).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_01"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_02"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_03"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_04"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_05"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_06"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_07"})).append(q.$new("div",{"class":"mcs-loader-circle mcs-loader-circle_08"})))}}this.node.jAppendTo(D);this.node.hide();if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.fx=new q.FX(this.node,{duration:C,onComplete:this._complete.jBind(this)})}else{this.node.jAddEvent("transitionend",i(function(F){if(F.target==this.node){this._complete()}}).jBind(this));this.node.jSetCssProp("transition","opacity "+C+"ms")}};B.prototype={complete:true,_complete:function(){this.complete=true;this.node.hide();this.flag=="removed"&&this.extraRemove()},show:function(){if(this.flag=="show"){return}this.complete=false;this.flag="show";this.node.jSetOpacity(1);this.node.show()},hide:function(D){if(this.flag=="hide"){return}this.flag=D?"removed":"hide";if(this.complete){this.extraRemove()}else{if(this.fx){this.fx.start({opacity:[0.6,0]})}else{setTimeout(function(){this.node.jSetOpacity(0)}.jBind(this),1)}}},jRemove:function(){if(this.flag=="hide"){this.flag="removed";this.complete&&this.node.kill()}else{this.hide()}},extraRemove:function(){this.node.kill()}};return B})();q.Modules||(q.Modules={});q.Modules.ShowItems=(function(){var B=function(){var I=[],D=300,F=0,G=0,J=false,H=this;q.$uuid(this);function E(){var M;if(I.length==0){H.jCallEvent("complete");return}if(!J&&I.length>0){J=true;M=I.shift();var L=i([]);L.push(M.item);if(M.item.clone&&M.item.clone.length>0){i(M.item.clone).jEach(i(function(N){L.push(N)}).jBind(this))}L.jEach(function(O,N){G+=1;if(M.visible){if(N){M.visible=false}}K(O,!!N,M.visible,M.callback,function(){J=false;E()},M.showReflection)})}}function C(M,O,L,N){if(M.progress){M.progress.hide(true)}F++;if(F==G){G=F=0;L();N()}}function K(R,Q,N,O,M,L){var S,T,P=i(R.content);if(R.load=="loaded"){C(R,Q,O,M);return}if(N){if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){T=i(P).jGetSize();S={opacity:[0,1],top:[T.height/2,0],left:[T.width/2,0],width:[0,T.width],height:[0,T.height]};this.itemFX=new q.FX(P,{duration:D,onComplete:i(function(V,U){P.jSetCss({overflow:"",position:"",top:"",left:"",width:"",height:""});Q&&(R.load="loaded");C(R,Q,V,U)}).jBind(this,O,M),onStart:i(function(){P.jSetCss({position:"relative",overflow:"hidden"})}).jBind(this)});this.itemFX.start(S)}else{P.jSetCssProp(e,"scale(0.2, 0.2)");P.jSetCssProp("transition","none");P.jSetOpacity(0);P.offsetHeight;P.parentNode.offsetHeight;P.jAddEvent("transitionend",i(function(U){if(U.target==P){this.jRemoveEvent(U.type);this.jSetCssProp(e,"");this.jSetCssProp("transition","")}}).jBind(P));if(!Q&&L){L(R)}P.jSetCssProp("transition",e+" "+D+"ms cubic-bezier(.5,.5,.69,1.9), opacity "+D+"ms linear");P.offsetHeight;P.parentNode.offsetHeight;P.jSetCssProp(e,"scale(1.0, 1.0)");P.jSetOpacity(1);Q&&(R.load="loaded");C(R,Q,O,M)}}else{P.jSetOpacity(1);if(Q){R.load="loaded"}else{L(R)}C(R,Q,O,M)}}this.push=function(N,M,L,O){I.push({item:N,visible:M,callback:L,showReflection:O});E()}};q.extend(B.prototype,q.customEvents);return B})();(function(B){B.QImageLoader=function(I,D){var C=0,H=this,G,E;function L(M){return function(N){(D[M]||B.$F).call(H,N,N.origItem);C--;K()}}function K(){var M;if(!I.length){}else{if(C<(D.queue||3)){G=I.shift();M=F(G.node);if(M){E=new B.ImageLoader(M,{onload:L("onload"),onerror:L("onerror"),onabort:L("onabort"),oncomplete:L("oncomplete")});E.origItem=G}else{(D.onload||B.$F).call(H,{size:i(G.node).jGetSize(),img:M},G);C--;K()}C++}}}function J(M){var N,O;N=(M&&M instanceof HTMLImageElement);if(N){O=M.getAttribute("data-src")||null;if(O){M.setAttribute("src",O)}}return(N&&M.getAttribute("src"))?M:null}function F(M){return B.jTypeOf(G)=="string"?M:(B.jTypeOf(M)=="object"?J(M.img):((M.tagName=="A"||M.tagName.toLowerCase()=="figure")?J(i(M).byTag("IMG")[0]||M.firstChild):(M.tagName=="IMG"?J(M):null)))}this.push=function(M,N){I[N?"unshift":"push"](M);D.delay||K();return this};this.abort=function(){E.destroy();count--};this.load=K;D.delay||I.length&&K()}})(p);var l,i=q.$,y=i,j=i;q.Scroll={};l={width:{oneOf:[{type:"number",minimum:1},{type:"string","enum":["auto"]}],"default":"auto"},height:{oneOf:[{type:"number",minimum:1},{type:"string","enum":["auto"]}],"default":"auto"},items:{oneOf:[{type:"number",minimum:1},{type:"array"},{type:"string","enum":["auto","fit"]}],"default":"auto"},scrollOnWheel:{oneOf:[{type:"boolean"},{type:"string","enum":["auto"]}],"default":"auto"},arrows:{oneOf:[{type:"boolean"},{type:"string","enum":["inside","outside","off"]}],"default":"outside"},autoplay:{type:"number","default":0},speed:{type:"number","default":600},loop:{oneOf:[{type:"string","enum":["infinite","rewind","off"]},{type:"boolean","enum":[false]}],"default":"infinite"},lazyLoad:{type:"boolean","default":false},orientation:{type:"string","enum":["horizontal","vertical"],"default":"horizontal"},step:{oneOf:[{type:"number",minimum:0},{type:"string","enum":["auto"]}],"default":"auto"},mode:{type:"string","enum":["scroll","animation","carousel","cover-flow"],"default":"scroll"},pagination:{type:"boolean","default":false},easing:{type:"string","default":"cubic-bezier(.8, 0, .5, 1)"},keyboard:{type:"boolean","default":false},autostart:{type:"boolean","default":true},onItemHover:{type:"function","default":q.$F},onItemOut:{type:"function","default":q.$F},onReady:{type:"function","default":q.$F},onStop:{type:"function","default":q.$F},onMoveStart:{type:"function","default":q.$F},onMoveEnd:{type:"function","default":q.$F}};document.createElement("figure");document.createElement("figcaption");var m=function(B){return{width:((parseInt(B.jGetCss("margin-left"))||0)+(parseInt(B.jGetCss("margin-right"))||0)),height:((parseInt(B.jGetCss("margin-top"))||0)+(parseInt(B.jGetCss("margin-bottom"))||0))}},h=function(B){return{width:((parseInt(B.jGetCss("padding-left"))||0)+(parseInt(B.jGetCss("padding-right"))||0)),height:((parseInt(B.jGetCss("padding-top"))||0)+(parseInt(B.jGetCss("padding-bottom"))||0))}},o=function(B){return{width:((parseInt(B.jGetCss("border-left-width"))||0)+(parseInt(B.jGetCss("border-right-width"))||0)),height:((parseInt(B.jGetCss("border-top-width"))||0)+(parseInt(B.jGetCss("border-bottom-width"))||0))}},A=function(B){return{width:i(B).jGetCss("width"),height:i(B).jGetCss("height")}},r=q.jBrowser.domPrefix,e=q.normalizeCSS("transform").dashize(),b=function(C,D){var B=false,E=0;q.$uuid(this);this._options={stopDownload:true,timingFunction:"cubic-bezier(.8, 0, .5, 1)",effect:"scroll",continuous:false,progress:false,debug:false,orientation:"horizontal",duration:500,loop:true,lazyLoad:true,step:"auto",keyboard:false};this.o=this._options;q.extend(this.o,D);this.container=i(C).jSetCssProp("white-space","nowrap");this.loop={firstItem:false,lastItem:false};this._setProperties();this.keyboardCallback=i(function(H){var G={},F=true;if(37===H.keyCode||39===H.keyCode){G.direction=H.keyCode==39?"forward":"backward";if(!this.o.loop){if("forward"===G.direction){if(this.loop.lastItem){F=false}}else{if(this.loop.firstItem){F=false}}}F&&this.jCallEvent("key_down",G)}}).jBind(this);this.name="scroll";this.items=i([]);this.itemsFirstClones=i([]);this.itemsLastClones=i([]);this.exitItems=i([]);this.enterItems=i([]);this.last=0;this.globalIndex=0;this.itemStep=this.o.step;this.containerPosition=0;this.l=null;this.globalLength=null;this.distance=null;this.allSize=0;this.correctPosition=0;this.containerWidth=0;this.direction="forward";this.callback=q.$F;this.fullViewedItems=0;this.stopScroll=false;this.moveTimer=null;this.wheelDiff=0;this.tempArray=null;this.prevIndex=this.last;this.wheel_=false;this.preloadAllFlag=false;this.disableReflection=false;this.loadAll=false;this.allNodes=null;this.doneFlag={};this.wrapperPosition=0;this.moveSettings={direction:"forward",disableEffect:false};this.queue=new q.QImageLoader([],{queue:1,onerror:i(function(G,H){var F=this.items[H.index];F.load="error";if(F.progress){F.progress.extraRemove();F.progress=null}F.node.jAddClass("mcs-noimg");this.performedOnClones(i(function(J,I){if(J.index==F.index){J.append=true;if(J.progress){J.progress.extraRemove();J.progress=null}J.node.load="error";J.node.jAddClass("mcs-noimg")}}).jBind(this));E++;if(this.o.lazyLoad){if(this.checkLoadingVisibleItems()){if(this.o.stopDownload||!this.doneFlag.two){this.jCallEvent("hideProgress");this.jCallEvent("groupLoad")}if(!this.move_){this.changeClones()}!this.doneFlag.two&&this.jCallEvent("complete")}}else{if(E==this.l&&!this.o.lazyLoad){this.loadAll=true;!this.doneFlag.two&&this.jCallEvent("complete")}}this.checkLoadedItems()}).jBind(this),onload:(function(I,J){var H=[],G=this.items[J.index],F;if(!G){return}G.node.append(G.content);if(!this.o.lazyLoad&&!this.disableReflection){try{this.setReflection(G);this.setCanvasPosition(G)}catch(I){this.disableReflection=true}}this.addCloneContent(G,i(function(){var K=true;if(i(["scroll","animation"]).contains(this.name)){if(!this.doneFlag.two&&!this.o.lazyLoad){K=J.index<this.fullViewedItems}}this.showItem(G,K,this.showReflection);G.load="loaded";E++;if(this.o.lazyLoad){if(this.checkLoadingVisibleItems()){if(this.o.stopDownload||!this.doneFlag.two){this.jCallEvent("hideProgress");this.jCallEvent("groupLoad")}if(!this.doneFlag.two){this.jCallEvent("complete")}}}else{if(E==this.l){this.loadAll=true;!this.doneFlag.two&&this.jCallEvent("complete")}}this.checkLoadedItems()}).jBind(this))}).jBind(this)})};b.prototype={constructor:b,showReflection:q.$F,setCanvasPosition:q.$F,setReflection:q.$F,showItem:function(F,I,H){var B,E,D,G=500,C=F.content;if(I){if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){B=i(C).jGetSize();E={opacity:[0,1],top:[B.height/2,0],left:[B.width/2,0],width:[0,B.width],height:[0,B.height]};D=new q.FX(C,{duration:G,onComplete:i(function(K,J){C.jSetCss({overflow:"",position:"",top:"",left:"",width:"",height:""});if(F.progress){F.progress.extraRemove();F.progress=null}}).jBind(this),onStart:i(function(){C.jSetCss({position:"relative",overflow:"hidden"})}).jBind(this)});D.start(E)}else{C.jSetCssProp("transition","none");C.jSetOpacity(0);C.offsetHeight;C.parentNode.offsetHeight;C.jAddEvent("transitionend",i(function(J){if(J.target==C){this.jRemoveEvent(J.type);this.jSetCssProp(e,"");this.jSetCssProp("transition","");if(F.progress){F.progress.extraRemove();F.progress=null}}}).jBind(C));C.jSetCssProp("transition",e+" "+G+"ms cubic-bezier(.5,.5,.69,1.9), opacity "+G+"ms linear");C.offsetHeight;C.parentNode.offsetHeight;C.jSetOpacity(1);H&&H(F)}}else{C.jSetOpacity(1);if(F.progress){F.progress.extraRemove();F.progress=null}}F.clone.length>0&&i(F.clone).jEach(i(function(J){if(J){i(J.content).jSetOpacity(1);J.load="loaded";if(J.progress){J.progress.extraRemove();J.progress=null}}}).jBind(this))},checkLoadedItems:function(){var B=0;this.items.jEach(i(function(C){if(C.load=="loaded"||C.load=="error"){B++}if(this.l==B){this.loadAll=true;this.jCallEvent("hideProgress")}}).jBind(this))},checkLoadingVisibleItems:function(){var B=0,C=0;if(this.loadAll){return true}for(;B<this.fullViewedItems;B++){if(this.items[this._getItemIndex(this.last+B)].load=="loaded"||this.items[this._getItemIndex(this.last+B)].load=="error"){C+=1}}return C==this.fullViewedItems},_sWidth:function(){return this.container.parentNode.jGetSize()[this.p_.size]},_setProperties:function(){var B={horizontal:{size:"width",pos:"left",otherSize:"height"},vertical:{size:"height",pos:"top",otherSize:"width"}};this.p_=B[this.o.orientation];if(this.o.step==0){this.o.step="auto"}if(!this.o.loop||"rewind"===this.o.loop){this.loop.firstItem=true}if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.container.jSetCssProp(this.p_.pos,0)}else{this.container.jSetCssProp(e,"translate3d(0, 0, 0)")}},_render:function(){this.container.offsetHeight},preloadAll:function(){if(this.loadAll||this.preloadAllFlag){return}this.preloadAllFlag=true;this.jCallEvent("showProgress");this.items.jEach(i(function(B){if(B.load=="notLoaded"){if(B.progress){B.progress.extraRemove();B.progress=null}B.clone.length>0&&i(B.clone).jEach(function(C){if(C.progress){C.progress.extraRemove();C.progress=null}});this.queue.push({node:B.content,index:B.index})}}).jBind(this));this.loadAll=true},preloadItem:function(C){var D,F=this.last,B=i([]),E,G;if(this.loadAll){return}if(this.o.lazyLoad){C&&(F=(C=="forward")?this._getItemIndex(F+this.fullViewedItems):this._getItemIndex(F-this.fullViewedItems));G=i(function(H){if(H.load=="notLoaded"){if(this.o.stopDownload){!C&&this.jCallEvent("showProgress")}else{H.progress&&H.progress.show()}H.load="load";this.queue.push({node:H.content,index:H.index})}}).jBind(this);for(D=0;D<this.fullViewedItems;D++){E=this.items[this._getItemIndex(F+D)];G(E);if(!C){G(this.items[this._getItemIndex(E.index+this.fullViewedItems)]);G(this.items[this._getItemIndex(E.index-this.fullViewedItems)])}}}},freeTouchPreload:function(G){var H,C,E,D,B=0,F=this.allNodes.length;if(G=="backward"){B=F-1;F=-1}if(!this.loadAll){while(B!=F){D=this.allNodes[B];H=D.jGetPosition();C=D.getAttribute("data-item");if(H[this.p_.pos]+this.items[0].size[this.p_.size]>this.wrapperPosition[this.p_.pos]&&H[this.p_.pos]<this.wrapperPosition[this.p_.pos]+this.containerWidth){E=this.items[C];if(E.load=="notLoaded"){E.load="load";E.progress&&E.progress.show();i(E.clone).jEach(i(function(I){I.progress&&I.progress.show()}).jBind(this));this.queue.push({node:E.content,index:E.index})}}G=="forward"?B++:B--}}},done:function(F){var C,B,E,D;if(this.doneFlag.one){return}this.doneFlag.one=true;B=this.l=this.items.length;this.containerWidth=this._sWidth();E=i(this.container.parentNode).jGetPosition();for(C=0;C<this.l;C++){D=this.items[C];D.size=D.node.jGetSize(true);this.allSize+=D.size[this.p_.size]}this.onResize()},done2:function(C){this.doneFlag.two=true;this.setItemStep();if(!q.jBrowser.ieMode||q.jBrowser.ieMode&&q.jBrowser.ieMode>9){this._initDragOnScroll()}this.itemEvent();if((!q.jBrowser.ieMode||q.jBrowser.ieMode&&q.jBrowser.ieMode>9)&&"scroll"===this.o.effect&&this.o.scrollOnWheel){this._initOnWheel()}if(i(["scroll","animation"]).contains(this.name)){for(var B=0;B<this.items.length;B++){if(B>=this.fullViewedItems){this.items[B].progress&&this.items[B].progress.show()}}}this.last=0;this.globalIndex=this.itemsFirstClones.length;i(window).jAddEvent("resize",this.onResize.jBind(this));if(this.o.keyboard){i(document).jAddEvent("keydown",this.keyboardCallback)}this.onResize();C&&C()},itemEvent:function(){this.items.jEach(i(function(B){B.content.showThis=i(function(){this.jCallEvent("show-this",{index:B.index})}).jBind(this);B.content.jAddEvent("click",i(function(C){if(this.move_){C.stop()}}).jBind(this))}).jBind(this))},setItemStep:function(D){var B,C=0;if(this.stopScroll){return}if(this.o.continuous){this.itemStep=this.fullViewedItems;return}for(B=0;B<this.l;B++){C+=this.items[B].size[this.p_.size];if(C>=this.containerWidth){if(this.itemStep=="auto"||this.itemStep>=B){if(this.o.effect=="animation"&&C-this.items[B].size[this.p_.size]+5<this.containerWidth||C==this.containerWidth){B+=1}this.itemStep=B;if(this.o.step!="auto"&&this.o.step<this.itemStep){this.itemStep=this.o.step}}break}}!this.itemStep&&(this.itemStep=1)},cloneFigure:function(C){var B=C.cloneNode();figure=document.createElement("figure"),figcaption=document.createElement("figcaption");q.$A(C.firstChild.childNodes).jEach(i(function(D){if(D.tagName.toLowerCase()=="figcaption"){q.$A(D.childNodes).jEach(i(function(E){i(figcaption).append(E.cloneNode(true))}).jBind(this));q.$A(D.attributes).jEach(i(function(E){figure.setAttribute(E,E.nodeValue)}).jBind(this));figure.append(figcaption)}else{i(figure).append(D.cloneNode(true))}}).jBind(this));q.$A(C.firstChild.attributes).jEach(i(function(D){figure.setAttribute(D,D.nodeValue)}).jBind(this));B.append(figure);return B},performedOnClones:function(B){if(this.itemsFirstClones.length>0){i([this.itemsFirstClones,this.itemsLastClones]).jEach(i(function(C){C.jEach(i(function(E,D){B(E,D)}).jBind(this))}).jBind(this))}},addCloneContent:function(C,D){if(this.itemsFirstClones.length>0){var B=i(function(){var E;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<9&&C.node.firstChild.tagName.toLowerCase()=="figure"){E=this.cloneFigure(C.content.cloneNode(true))}else{E=C.content.cloneNode(true)}E.childNodes&&q.$A(E.childNodes).jEach(i(function(F){if(i(F).jHasClass&&i(F).jHasClass("MagicScroll-progress-bar")){F.kill()}}).jBind(this));return E}).jBind(this);this.performedOnClones(i(function(F,E){if(F.index==C.index&&!F.append){F.content=B();this.items[C.index].clone.push(F);F.append=true;F.node.append(F.content)}}).jBind(this))}D&&D()},_prepareClones:function(){var B,C=0,F=0,H=0,E={left:0,top:0},G,D;if(this.stopScroll){return}for(B=0;B<this.l;B++){C+=this.items[B].size[this.p_.size];H++;if(this.containerWidth<=C){break}}if(this.l>1&&(H>this.fullViewedItems||this.itemsFirstClones.length==0)){F=this.itemsFirstClones.length;for(B=F;B<H;B++){G={node:this.items[this.l-1-B].node.cloneNode(),load:"notLoaded",append:false};i(G.node).setAttribute("data-item",this.l-1-B);G.index=this.items[this.l-1-B].index;if(this.o.lazyLoad&&this.o.progress){G.progress=new q.Modules.Progress(G.node);G.progress.show()}this.itemsFirstClones.push(G);D={node:this.items[B].node.cloneNode(),load:"notLoaded",append:false};i(D.node).setAttribute("data-item",B);D.index=this.items[B].index;if(this.o.lazyLoad&&this.o.progress){D.progress=new q.Modules.Progress(D.node);D.progress.show()}this.itemsLastClones.push(D);i([D.node,G.node]).jEach(i(function(I){I.jAddEvent("click",i(function(J){if(this.move_){J.stop()}}).jBind(this))}).jBind(this));this.container.append(D.node);this.container.append(G.node,"top");i([this.items[this.l-1-B],this.items[B]]).jEach(i(function(I){if(I.load=="loaded"){this.addCloneContent(I,i(function(){var J=true;if(i(["scroll","animation"]).contains(this.name)){if(!this.doneFlag.two&&!this.o.lazyLoad){J=I.index<this.fullViewedItems}}this.showItem(I,J);I.clone.length>0&&i(I.clone).jEach(function(K){if(K.progress){K.progress.extraRemove();K.progress=null}})}).jBind(this))}}).jBind(this))}if(F){this.fullViewedItems+=H-F}else{this.fullViewedItems=H}}else{this.fullViewedItems=H}this.correctPosition=this.containerPosition=0;C=0;for(B=0;B<this.itemsFirstClones.length;B++){C+=this.items[this.l-1-B].size[this.p_.size]}this.correctPosition+=C;this.containerPosition-=C;E[this.p_.pos]=this.containerPosition;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.container.jSetCssProp(this.p_.pos,E[this.p_.pos])}else{this.correctContainerPosition()}},push:function(B){this.l=this.items.length;B.index=this.l;B.load="notLoaded";B.clone=[];if(this.o.progress&&this.o.lazyLoad){B.progress=new q.Modules.Progress(B.node,true);if(!this.o.stopDownload){B.progress.show()}}B.node.setAttribute("data-item",B.index);B.node.jAddEvent("mouseover mouseout",i(function(D){var C=D.getRelated();while(C&&C!==B.node){C=C.parentNode}if(C==B.node){return}if("mouseover"===D.type){this.jCallEvent("on-item-hover",{itemIndex:B.index})}else{this.jCallEvent("on-item-out",{itemIndex:B.index})}}).jBind(this));this.items.push(B)},_getItemIndex:function(B){B%=this.l;B<0&&(B=B+this.l);return B},jump:function(C,D){var B;if(C=="forward"||C=="backward"){this.direction=C}if(this.move_||this.wheel_){return}this.move_=true;if(q.jTypeOf(C)=="object"){this.direction=C.direction;C.disableEffect=false;C.defaultMove=false}else{if(/forward|backward|^\+|^\-/.test(C)){if(/^\+|^\-/.test(C)){B=/^\+/.test(C)?"forward":"backward";C={goTo:Math.abs(parseInt(C)),direction:B};C.goTo>this.l&&(C.goTo=this.l);C.target=this._getItemIndex(C.direction=="forward"?(this.last+C.goTo):(this.last-C.goTo))}else{C={direction:C};C.target=this._getItemIndex(C.direction=="forward"?(this.last+this.itemStep):(this.last-this.itemStep))}C.disableEffect=false;C.defaultMove=true}else{if(q.jTypeOf(parseInt(C))=="number"){C={target:this._getItemIndex(C),disableEffect:true,defaultMove:false}}}}C.callback=D;if(!this.o.loop){if(this.loop.firstItem||this.loop.lastItem){if(this.loop.firstItem){if("backward"===C.direction){this.move_=false;D(null,true);return}}else{if("forward"===C.direction){this.move_=false;D(null,true);return}}}}this["_"+this.name](C)},_shiftContainer:function(E,C){var D={left:0,top:0},F=false,B=C||this.containerPosition;if(E=="forward"){if(B+this.correctPosition-this.distance+this.allSize<0){this.containerPosition=B+this.allSize;D[this.p_.pos]=this.containerPosition;F=true}}else{if(B+this.distance>0){this.containerPosition=B-this.allSize;D[this.p_.pos]=this.containerPosition;F=true}}if(F){if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.container.jSetCssProp(this.p_.pos,D[this.p_.pos]+"px")}else{this.container.jSetCssProp(e,"translate3d("+D.left+"px, "+D.top+"px, 0)");this.container.jSetCssProp("transition",e+" 0ms "+this.o.timingFunction);this._render();if(this.o.effect=="animation"){this.previous=this.globalIndex=this._getGlobalIndex();if(E=="forward"){this.globalIndex+=this.itemStep}else{this.globalIndex-=this.itemStep}}}}return F},_calcDistance:function(E,D){var C,B=true;if(!D){if(this.o.step=="auto"){this.itemStep="auto";this.setItemStep(E=="backward")}B=false;D=this.itemStep}else{this.o.stopDownload=false}for(C=D;C>0;C--){this.last=this._getItemIndex((E=="forward")?(this.last+1):(this.last-1));this.globalIndex=(E=="forward")?(this.globalIndex+1):(this.globalIndex-1);this.distance+=this.items[(E=="forward")?this._getItemIndex(this.last-1):this.last].size[this.p_.size]}if("infinite"===this.o.loop){if(!this.o.continuous){this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})}}else{if("scroll"===this.o.effect&&this.loop.lastItem&&E=="backward"){if(B){this.last-=(this.itemsVisible-1)}else{this.last-=(D-1)}if(this.last<0){this.last=0}}this.jCallEvent("enable");if(this.loop.lastItem&&E=="forward"){this.loop.lastItem=false;this.loop.firstItem=true;this.containerPosition=0;this.distance=0;this.last=0;this.globalIndex=0;this.jCallEvent("first-frame");this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})}else{if(this.loop.firstItem&&E=="backward"){this.loop.firstItem=false;this.loop.lastItem=true;this.distance=0;this.last=this.l-1;if(this.o.effect=="scroll"){this.globalIndex=this.l-this.itemsVisible;this.containerPosition=(this.allSize-this.containerWidth)*(-1)}else{this.globalIndex=this.l-this.l%this.itemsVisible;this.containerPosition=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*(-1)}this.jCallEvent("last-frame");this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes(true)})}else{this.loop.lastItem=false;this.loop.firstItem=false;if(E=="forward"){if(this.containerPosition-this.distance<=this.containerWidth-this.allSize||this.containerPosition-this.distance+1<=this.containerWidth-this.allSize){this.jCallEvent("last-frame");if(this.o.effect=="scroll"||this.o.effect=="animation"&&"infinite"===this.o.loop){this.distance=this.containerPosition-(this.containerWidth-this.allSize)}else{this.distance=this.containerWidth}this.loop.lastItem=true;this.last=this.l-1;this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes(true)})}else{this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})}}else{if(this.containerPosition+this.distance>=0||this.containerPosition+this.distance===-1){this.jCallEvent("first-frame");this.distance=Math.abs(this.containerPosition);this.loop.firstItem=true;this.globalIndex=0;this.last=0;this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})}else{this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})}}}}}},jumpToNumber:function(F){var B,D,C=0,E;if(!F.direction){C=Math.floor(this.fullViewedItems/2);if(this.fullViewedItems%2==0){C-=1}C<0&&(C=0)}if("infinite"===this.o.loop){F.target=this._getItemIndex(F.target-C)}if(this.last!=F.target){this.o.stopDownload=false;E=i(function(J){var H=this.last,I=0,G;do{I++;!J?H++:H--;G=this._getItemIndex(H)}while(G!=F.target);return I}).jBind(this);if(!F.direction){if("infinite"===this.o.loop){F.direction=E()<=E(true)?"forward":"backward"}else{F.direction=F.target>this.last?"forward":"backward"}}this.jCallEvent("enable");if("infinite"===this.o.loop){while(this.last!=F.target){this.last=this._getItemIndex(F.direction=="forward"?++this.last:--this.last);this.globalIndex=F.direction=="forward"?++this.globalIndex:--this.globalIndex;this.distance+=this.items[this.last].size[this.p_.size]}}else{this.loop.lastItem=false;this.loop.firstItem=false;this.last=F.target;D=0;for(B=0;B<F.target-C;B++){D+=this.items[B].size[this.p_.size]}this.globalIndex=F.target;this.containerPosition=0-this.correctPosition-D;if(this.o.effect=="scroll"&&this.containerPosition<=0-(this.allSize-this.containerWidth)||this.containerPosition<=0-((this.allSize+(this.l%this.itemStep)*this.items[0].size[this.p_.size])-this.containerWidth)){if(this.o.effect=="scroll"){this.containerPosition=0-(this.allSize-this.containerWidth)}this.loop.lastItem=true;this.jCallEvent("last-frame");this.last=this.l-1}if(this.containerPosition>=0){this.containerPosition=0;this.jCallEvent("first-frame");this.loop.firstItem=true;this.last=0}}}else{this.move_=false;this.wheel_=false;this.jCallEvent("disableHold")}},_scroll:function(E){var B=this.containerPosition,C=false,D;this.previous=this.globalIndex;this.distance=0;if((!this.o.loop||"rewind"===this.o.loop)&&this.o.effect=="animation"){if(this.loop.lastItem&&E.direction=="forward"||this.loop.firstItem&&E.direction=="backward"){C=true}}if(E.defaultMove){this._calcDistance(E.direction,E.goTo)}else{this.jumpToNumber(E)}if(C){E.direction=E.direction=="forward"?"backward":"forward"}if(0!==this.wheelDiff){D=this.items[this.prevIndex].size[this.p_.size]-this.wheelDiff;if(E.direction=="forward"){this.distance-=D}else{this.distance+=D}this.wheelDiff=0}"infinite"===this.o.loop&&this._shiftContainer(E.direction);if(E.direction=="forward"){this.containerPosition-=this.distance}else{this.containerPosition+=this.distance}this.moveSettings.direction=E.direction;this.moveSettings.disableEffect=E.disableEffect;if(B!=this.containerPosition){this.callback=E.callback;if(this.o.stopDownload&&!this.loadAll&&!this.checkLoadingVisibleItems()){this.jCallEvent("showProgress");this.preloadItem();this.bindEvent("groupLoad",i(function(F){this.move_&&this._move(null,F.direction,F.disableEffect)}).jBind(this,this.moveSettings))}else{if(!this.loadAll){this.preloadItem()}this._move(null,E.direction,E.disableEffect)}}else{this.jCallEvent("hold")}},_move:function(C,B,E){var D={left:0,top:0};this.move_=true;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){D={};D[this.p_.pos]=[parseInt(this.container.jGetCss(this.p_.pos)),this.containerPosition];this.fx=new q.FX(this.container,{transition:this.o.timingFunction,duration:C||this.o.duration,onComplete:this._onComplete.jBind(this),onStart:i(function(){this.stop_=false}).jBind(this)}).start(D)}else{D[this.p_.pos]=this.containerPosition;if(this.o.effect=="animation"&&!E){this._moveEffect(B,D)}else{this.container.jRemoveEvent("transitionend");this.container.jAddEvent("transitionend",i(function(F){if(F.target==this.container){this.container.jRemoveEvent(F.type);if(E){this.globalIndex=this._getGlobalIndex();this._cleansingStyles()}this._onComplete()}}).jBind(this));this.container.jSetCssProp(e,"translate3d("+D.left+"px, "+D.top+"px, 0)");this.container.jSetCssProp("transition",e+" "+(C||this.o.duration)+"ms "+this.o.timingFunction)}}},_moveEffect:function(H,G){var F,C,E,D=this.container.childNodes,B=D.length,I=i(function(J){J%=this.globalLength;J<0&&(J=J+this.globalLength);return J}).jBind(this);this.exitItems.length=0;this.enterItems.length=0;for(F=0;F<this.itemStep;F++){if("infinite"===this.o.loop){C=I(this.previous+F)}else{C=this.previous+F<B?this.previous+F:null}C!=null&&this.exitItems.push(D[C]);if("infinite"===this.o.loop){E=I(this.globalIndex+F)}else{E=this.globalIndex+F<B?this.globalIndex+F:null}E!=null&&this.enterItems.push(D[E])}if(H=="backward"){this.exitItems.reverse();this.enterItems.reverse()}this.container.setAttribute("data-"+H,"");this.exitItems.jEach(i(function(K,J){K.jAddEvent(r+"AnimationEnd animationend",i(function(L,M,N){if(L==this.exitItems[M]){L.jRemoveEvent(r+"AnimationEnd animationend").setAttribute("data-exited","");if(M==this.exitItems.length-1){this.exitItems.jEach(i(function(P,O){P.removeAttribute("data-animation-nth");P.removeAttribute("data-action")}).jBind(this));this.enterItems.jEach(i(function(P,O){if(O==this.enterItems.length-1){P.jAddEvent(r+"AnimationEnd animationend",i(function(Q){if(Q.target==P){P.jRemoveEvent(r+"AnimationEnd animationend");this.enterItems.jEach(i(function(R,S){R.removeAttribute("data-animation-nth");R.removeAttribute("data-action")}).jBind(this));this.exitItems.jEach(i(function(R,S){R.removeAttribute("data-exited")}).jBind(this));this.container.removeAttribute("data-"+H);this._render();this._onComplete()}}).jBind(this))}P.setAttribute("data-entering","");P.jAddEvent(r+"AnimationStart animationstart",i(function(Q){if(Q.target==this){this.jRemoveEvent(r+"AnimationStart animationstart");P.removeAttribute("data-entering")}}).jBind(P));P.setAttribute("data-action","enter");P.setAttribute("data-animation-nth",(O+1))}).jBind(this));this.container.jSetCssProp(e,"translate3d("+G.left+"px, "+G.top+"px, 0)")}}}).jBind(this,K,J))}).jBind(this));this.exitItems.jEach(i(function(K,J){K.setAttribute("data-exiting","");K.jAddEvent(r+"AnimationStart animationstart",i(function(L){if(L.target==this){K.jRemoveEvent(r+"AnimationStart animationstart");this.removeAttribute("data-exiting")}}).jBind(K));K.setAttribute("data-action","exit");K.setAttribute("data-animation-nth",(J+1))}).jBind(this))},getVisibleIndexes:function(E){var F=0,D=this.itemStep,B=[],C;if(E){if(this.o.effect=="scroll"){F=this.l-this.itemStep}else{F=this.l%this.itemStep?this.l-this.l%this.itemStep:this.l-this.itemStep}D=this.l}for(;F<D;F++){if(!E){C=this.last+F}else{C=F}B.push(this._getItemIndex(C))}return B},_onComplete:function(){this.move_=false;this.continuousPause=false;this.callback&&this.callback(this.getVisibleIndexes(this.loop.lastItem))},_cleansingStyles:function(){this.container.jSetCssProp("transition",e+" 0ms")},getMatrixPosition:function(G){var F={x:0,y:0},D=G.jGetCss(e)||"",E=/3d/.test(D)?(/matrix3d\(([^\)]+)\)/):(/matrix\(([^\)]+)\)/),C=/3d/.test(D)?12:4,B=/3d/.test(D)?13:5;(G.jGetCss(e)||"").replace(E,function(J,I){var H=I.split(",");F.x+=parseInt(H[C],10);F.y+=parseInt(H[B])});return F},_getGlobalIndex:function(){var E,D,B,C=100000,F=this.container.parentNode.jGetPosition()[this.p_.pos];for(E=0;E<this.globalLength;E++){D=this.container.childNodes[E].jGetPosition()[this.p_.pos];if(C>Math.abs(F-D)){C=Math.abs(F-D);B=E}else{break}}return B},changeClones:function(){if(this.itemsFirstClones.length==0){return}var C,B,D=i(function(F,G){var H,E;if(this.items[G].node!=F&&this.items[G].load=="loaded"){for(E=0;E<this.globalLength;E++){if(this.items[G].node==this.container.childNodes[E]){H=E;break}}if(H<B){this.container.insertBefore(F,this.container.childNodes[H]);if(B+1<=this.globalLength-1){this.container.insertBefore(this.items[G].node,this.container.childNodes[B+1])}else{this.container.appendChild(this.items[G].node)}}else{this.container.insertBefore(this.items[G].node,F);if(H+1<=this.globalLength-1){this.container.insertBefore(F,this.container.childNodes[H+1])}else{this.container.appendChild(F)}}}}).jBind(this);B=this._getGlobalIndex();for(C=0;C<this.fullViewedItems;C++){D(this.container.childNodes[B],this._getItemIndex(this.last+C));B++}},correctItemPosition:function(J){var H,F,G,M=0,C=0,L,I=this.container.parentNode.jGetPosition()[this.p_.pos]+1,E=this.container.jGetPosition()[this.p_.pos]-I,K=Math.abs(Math.abs(E)-Math.abs(this.containerPosition)),D,B=i(function(N){return parseInt(this.container.childNodes[N].getAttribute("data-item"))}).jBind(this);(K>0&&K<1)&&(K=0);if(J=="forward"){I+=K}else{I-=K}for(H=0;H<this.globalLength;H++){G=this.container.childNodes[H].jGetPosition()[this.p_.pos];if(G==I){this.last=B(H);return 0}L=parseInt(this.container.childNodes[H].jGetSize()[this.p_.size]);if(G<I&&G+L>I){D=H;if(J=="forward"){D=H+1>this.globalLength-1?this.globalLength-1:H+1;H++}for(F=0;F<H;F++){C+=this.items[B(F)].size[this.p_.size]}M=Math.abs(Math.abs(this.containerPosition)-C);this.last=B(D);break}}return M},_initDragOnScroll:function(){var ab,G,Z,R,aa,F,B=(this.p_.pos=="left")?"x":"y",H={x:0,y:0},P=this.o.effect=="scroll",S,U=true,K={x:0,y:0},D=false,T=false,I=null,N=0,V=null,O=false,C=i(function(ae){var ad,ac=0;if(ae>this.containerWidth){ae=this.containerWidth}for(ad=1.5;ad<=90;ad+=1.5){ac+=(ae*Math.cos(ad/Math.PI/2))}return this.containerWidth>ac?ac:this.containerWidth}).jBind(this),E=i(function(ae){var af,ac=0,ad,ag;while(ac>this.containerPosition){ac-=this.containerWidth}if(Math.abs(ac-this.containerPosition)>this.containerWidth/2){ac+=this.containerWidth}ag=ac;for(af=0;af<this.globalLength;af++){ad=parseInt(this.container.childNodes[af].getAttribute("data-item"));if(ag==0){this.last=ad;break}ag+=this.items[ad].size[this.p_.size]}return ac}).jBind(this),X=i(function(ac){T=true;i(document.body).jAddClass("mcs-dragging");this.o.stopDownload=false;U=true;clearTimeout(this.moveTimer);if(this.o.effect=="animation"){this.stopEffect()}this.stopWhell&&this.stopWhell();H={x:0,y:0};B=(this.p_.pos=="left")?"x":"y";this.jCallEvent("drag-start");this.container.jRemoveEvent("transitionend");this.containerPosition=this.getMatrixPosition(this.container)[B];H[B]=this.containerPosition;this.container.jSetCssProp(e,"translate3d("+H.x+"px, "+H.y+"px, 0)");this.container.jSetCssProp("transition","none");this._render();this.o.effect=="scroll"&&(P=true);this.move_=true}).jBind(this),Q=i(function(ad){i(document.body).jRemoveClass("mcs-dragging");if(T){T=false;var ac=this.containerPosition;if(!U){ad.returnValue=false;M();G=ad.timeStamp-ab;if(this.o.effect=="scroll"){if(G>200){F=aa;P=false}else{F=C(Math.abs(K[B]-ad[B]))}aa=F;if("infinite"===this.o.loop){this.distance=Math.abs(aa);this._shiftContainer(Z)}if("infinite"===this.o.loop||this.containerPosition<=0){if(Math.abs(this.containerPosition)<aa){aa=Math.abs(this.containerPosition)}this.containerPosition-=aa}Z=="forward"?this.containerPosition-=this.correctItemPosition(Z):this.containerPosition+=this.correctItemPosition(Z);if(!this.o.loop||"rewind"===this.o.loop){this.jCallEvent("enable");this.loop.firstItem=false;this.loop.lastItem=false;if(this.containerPosition>0){this.containerPosition=0;this.last=0;P=true;this.jCallEvent("first-frame");this.loop.firstItem=true}if(this.containerPosition<this.containerWidth-this.allSize){this.containerPosition=this.containerWidth-this.allSize;this.last=this.l-1;P=true;this.jCallEvent("last-frame");this.loop.lastItem=true}}S=P?600:300}else{P=true;this.distance=0;this.containerPosition=E();"infinite"===this.o.loop&&this._shiftContainer(Z);if(G<200){this.distance=this.containerWidth;"infinite"===this.o.loop&&this._shiftContainer(Z);if(Z=="forward"){this.containerPosition-=this.containerWidth}else{this.containerPosition+=this.containerWidth}}if(!this.o.loop||"rewind"===this.o.loop){this.jCallEvent("enable");this.loop.firstItem=false;this.loop.lastItem=false;if(this.containerPosition>=0){this.containerPosition=0;this.last=0;this.loop.firstItem=true;this.jCallEvent("first-frame")}if(this.containerPosition<=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*(-1)){this.containerPosition=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*(-1);this.last=this.l-1;this.loop.lastItem=true;this.jCallEvent("last-frame")}}S=500}H[B]=this.containerPosition;this.container.jAddEvent("transitionend",i(function(ae){if(ae.target==this.container){if(this.o.effect=="animation"){this.container.jSetCssProp("transition","none");this.globalIndex=this._getGlobalIndex()}if(this.o.effect=="animation"){this.last=parseInt(this.container.childNodes[this._getGlobalIndex()].getAttribute("data-item"))}if("infinite"===this.o.loop){this.changeClones()}this.move_=false;this.wheel_=false;P=false;U=true;this.preloadItem();this.jCallEvent("drag-end",{arr:this.getVisibleIndexes(this.loop.lastItem)})}}).jBind(this));if(ac==this.containerPosition){this.move_=false;P=false;U=true}this.container.jSetCssProp("transition",e+" "+S+"ms cubic-bezier(.22,.63,.49,.8)");this.container.jSetCssProp(e,"translate3d("+H.x+"px, "+H.y+"px, 0)")}else{this.move_=false}}}).jBind(this),J=0,M=i(function(){clearTimeout(V);V=null;O=false;J=0}).jBind(this),Y=i(function(){var ac=J*0.2;if(Math.abs(ac)<0.0001){M();return}J-=ac;this.containerPosition-=ac;H[B]=this.containerPosition;this.container.jSetCssProp(e,"translate3d("+H.x+"px, "+H.y+"px, 0)");V=setTimeout(Y,16)}).jBind(this),W=i(function(ad){if(T){var ac=ad[B]-N>0?"backward":"forward";U=false;if("infinite"===this.o.loop){this.distance=Math.abs(aa);this._shiftContainer(ac)}if(q.jBrowser.ieMode){J+=aa;if(!O){O=true;Y()}}else{this.container.jSetCssProp("transition",e+" 0ms");if(this.o.effect=="animation"){}this.containerPosition-=aa;H[B]=this.containerPosition;this.container.jSetCssProp(e,"translate3d("+H.x+"px, "+H.y+"px, 0)")}this.freeTouchPreload(ac)}}).jBind(this),L=i(function(ac){if(this.stopScroll||this.o.effect=="animation"&&P){return}if("dragstart"==ac.state){ab=ac.timeStamp;K.x=ac.x;K.y=ac.y;N=ac[B]}else{Z=(aa>0)?"forward":"backward";aa=N-ac[B];this.moveSettings.direction=Z;if("dragend"==ac.state){if(D){D=false;Q(ac)}}else{if(this.o.orientation=="vertical"||Math.abs(ac.x-K.x)>Math.abs(ac.y-K.y)){ac.stopDefaults();if(!D){if(this.o.effect=="animation"&&this.move_){return}D=true;X(ac)}else{W(ac)}}}}N=ac[B]}).jBind(this);if(!q.jBrowser.ieMode||q.jBrowser.ieMode&&q.jBrowser.ieMode>9){this.container.parentNode.jAddEvent("mousedrag touchdrag",L)}},_initOnWheel:function(){var F,G,C=0,E={x:0,y:0},D=(this.p_.pos=="left")?"x":"y",B=i(function(I){var H=C*(I||0.2);F=H>0?"forward":"backward";C-=H;if(Math.abs(H)<0.00001){clearTimeout(this.moveTimer);this.last=parseInt(this.container.childNodes[this._getGlobalIndex()].getAttribute("data-item"));this.changeClones();this.wheelDiff=this._getWheelDiff();this.prevIndex=this.last;C=0;this.distance=0;this.moveTimer=null;this.wheel_=false;this.move_=false;this.jCallEvent("drag-end",{arr:this.getVisibleIndexes(this.loop.lastItem)});return}this.distance=Math.abs(H);"infinite"===this.o.loop&&this._shiftContainer(F);this.containerPosition-=H;this.distance=0;this.freeTouchPreload(F);if(!this.o.loop||"rewind"===this.o.loop){if(this.containerPosition>0){this.containerPosition=0;C=0.00001;this.jCallEvent("first-frame")}else{if(this.containerPosition<this.containerWidth-this.allSize){this.containerPosition=this.containerWidth-this.allSize;C=0.00001;this.jCallEvent("last-frame")}else{this.jCallEvent("enable")}}}E[D]=this.containerPosition;this.container.jSetCssProp(e,"translate3d("+E.x+"px, "+E.y+"px, 0)");this.moveTimer=setTimeout(B.jBind(this,I),30)}).jBind(this);if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10||this.stopScroll){return}this.stopWhell=i(function(){if(this.wheel_){clearTimeout(this.moveTimer);C=0;this.distance=0;this.moveTimer=null;this.wheel_=false;this.move_=false}}).jBind(this);this.container.jAddEvent("mousescroll",i(function(H){var I=(Math.abs(H.deltaY)<Math.abs(H.deltaX)?H.deltaX:H.deltaY*(!H.isMouse?-1:-30));if(this.move_){return}if((true===this.o.scrollOnWheel&&H.isMouse)||"vertical"===this.o.orientation&&Math.abs(H.deltaY)>Math.abs(H.deltaX)||"horizontal"===this.o.orientation&&Math.abs(H.deltaY)<Math.abs(H.deltaX)){H.stop();this.wheel_=true;if(0===C){this.container.jSetCssProp("transition",e+" 0ms");E={x:0,y:0};D=(this.p_.pos=="left")?"x":"y"}this.jCallEvent("drag-start");C+=I;if(!this.moveTimer){B(0.4)}}}).jBind(this))},_getWheelDiff:function(){var C,B,D=this.containerPosition,E=i(["tempArray","items","itemsLastClones"]);this.tempArray=[];this.itemsFirstClones.jEach(i(function(F){this.tempArray.push(F)}).jBind(this));this.tempArray.reverse();for(C=0;C<E.length;C++){for(B=0;B<this[E[C]].length;B++){D+=this.items[this[E[C]][B].index].size[this.p_.size];if(D>0){this.last=this[E[C]][B].index;this.tempArray=null;return D}}}},pause:function(){var B,C;if(!this.o.continuous||this.continuousPause||!this.move_||this.o.effect=="animation"){return}this.continuousPause=true;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.fx&&(this.fx.options.onComplete=q.$F);this.fx&&this.fx.stop();this.fx=null;this.containerPosition=Math.round(parseInt(this.container.jGetCss(this.p_.pos)))}else{this.containerPosition=this.getMatrixPosition(this.container)[(this.p_.pos=="left")?"x":"y"]}B=this.correctItemPosition(this.direction);C=this.o.duration/this.distance*B;if(this.direction=="forward"){this.containerPosition-=B}else{this.containerPosition+=B}this._move(C)},stop:function(){this.stop_=true;this.move_=false;this.stopWhell&&this.stopWhell();if(this.o.effect=="animation"){this.stopEffect()}if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.fx&&this.fx.stop(true);this.fx=null}else{this._cleansingStyles()}},stopEffect:function(){var B={x:0,y:0};if(!q.jBrowser.ieMode||q.jBrowser.ieMode&&q.jBrowser.ieMode>10){B[this.p_.pos]=this.containerPosition;this.container.removeAttribute("data-forward");this.container.removeAttribute("data-backward");i([this.exitItems,this.enterItems]).jEach(i(function(C,D){if(C.length>0){C.jEach(i(function(F,E){F.jRemoveEvent(r+"AnimationStart animationstart "+r+"AnimationEnd animationend");F.removeAttribute("data-animation-nth");F.removeAttribute("data-action");if(!D){F.removeAttribute("data-exiting");F.removeAttribute("data-exited")}else{F.removeAttribute("data-entering")}}).jBind(this))}}).jBind(this));this.container.jSetCssProp(e,"translate3d("+B.left+"px, "+B.top+"px, 0)");this.move_=false;this._render()}},onResize:function(){var B,C;this.stop();this.continuousPause=false;this.wrapperPosition=i(this.container.parentNode).jGetPosition();this.containerWidth=this._sWidth();this.itemsVisible=0;this.allSize=0;for(B=0;B<this.l;B++){this.items[B].size=this.items[B].node.jGetSize(true);this.allSize+=this.items[B].size[this.p_.size];if(this.allSize<=this.containerWidth){this.itemsVisible+=1}}if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.last=0}else{this.correctContainerPosition()}this.distance=0;this.itemStep=this.o.step;if(this.allSize<=this.containerWidth){this.stopScroll=true;this.jCallEvent("hideArrows");this.jCallEvent("disable");this.correctPosition=0;this.containerPosition=0;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.container.jSetCssProp(this.p_.pos,0)}else{this.container.jSetCssProp(e,"translate3d(0px, 0px, 0)")}this._removeClones()}else{this.stopScroll=false;this.jCallEvent("showArrows");this.jCallEvent("enable");if(!this.o.loop||"rewind"===this.o.loop){if(this.loop.firstItem){this.jCallEvent("first-frame")}if(this.loop.lastItem){this.jCallEvent("last-frame")}}}if((this.allSize>this.containerWidth)&&("infinite"===this.o.loop||this.o.continuous)){this._prepareClones()}else{this.fullViewedItems=C=0;for(B=0;B<this.l;B++){C+=this.items[B].size[this.p_.size];this.fullViewedItems++;if(this.containerWidth<=C){break}}}this._shiftContainer("forward");this.container.jRemoveEvent("transitionend");this.globalIndex=this._getGlobalIndex();this.globalLength=this.container.childNodes.length;this.setItemStep();this.changeClones();this.allNodes=q.$A(this.container.childNodes);this.o.lazyLoad?this.preloadItem():this.preloadAll()},correctContainerPosition:function(){var D,F,E={left:0,top:0},C=this.items[this.last].node.jGetPosition()[this.p_.pos],B=this.container.parentNode.jGetPosition()[this.p_.pos];if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){}else{if(!this.o.loop&&this.loop.lastItem){if("scroll"===this.o.effect){E[this.p_.pos]=this.containerWidth-this.allSize}else{F=this.itemsVisible-this.l%this.itemsVisible;E[this.p_.pos]=this.containerWidth-(this.allSize+this.items[0].size[this.p_.size]*F)}}else{D=this.getMatrixPosition(this.container)["left"===this.p_.pos?"x":"y"];E[this.p_.pos]=D-(C-B)}this.containerPosition=E[this.p_.pos];this.container.jSetCssProp(e,"translate3d("+E.left+"px, "+E.top+"px, 0)")}},rightQueue:function(){var H=0,G=true,C=this.l-1,D=i(["itemsLastClones","items","itemsFirstClones"]),F=i(function(L,J){var I,K=null;for(I=0;I<L.length;I++){if(L[I].index==J){K=L[I].node;break}}return K}).jBind(this),E=i(function(I){return(H==0)?I-1:(H-1)}).jBind(this),B=i(function(L,J){var K,I=L.length;if(I>0){for(K=0;K<I;K++){if(G){G=false;H=I-1;this.container.appendChild(L[H].node)}else{this.container.insertBefore(F(L,!H?C:E(I)),F(!H?this[D[J-1]]:L,H));H=!H?C:H-1}}}}).jBind(this);D.jEach(i(function(I,J){B(this[I],J);H=0}).jBind(this));this.last=0},_removeClones:function(){this.itemsFirstClones.jEach(function(B){B.node.kill()});this.itemsFirstClones=i([]);this.itemsLastClones.jEach(function(B){B.node.kill()});this.itemsLastClones=i([])},update:function(B){var C={left:0,top:0};this.stop();this.containerPosition=this.last=0;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){this.container.jSetCss(C)}else{this.container.jSetCssProp(e,"translate3d("+C.left+"px, "+C.top+"px, 0)")}this.itemStep=this.o.step;if((!this.o.continuous&&(!this.o.loop||"rewind"===this.o.loop))&&this.itemsFirstClones.length>0){this.correctPosition=0;this._removeClones()}this.onResize();this.rightQueue();this.move_=false},setNewOptions:function(B){for(var C in B){this.o[C]=B[C]}this._setProperties()},dispose:function(){this.stop();this._removeClones();i(window).jRemoveEvent("resize");i(document).jRemoveEvent("keydown");this.container.jRemoveEvent("touchdrag mousedrag");this.items.jEach(i(function(B){B.node.jRemoveEvent("mouseover mouseout");delete B.content.showThis}).jBind(this))}};q.extend(b.prototype,q.customEvents);q.Scroll.Effect=b;var u=function(B,C){q.Scroll.Effect.apply(this,arguments);this._options={radius:"auto",gradientBezier:i([0.44,0.59,0.35,0.89]),startAlpha:255,timingFunction:"cubic-bezier(.8, 0, .5, 1)"};this.name="carousel";this.o=this._options;q.extend(this.o,C);this.distance=70;this.lastAngle=0;this.nextAngle=0;this.moveTimer=null;this.fxk=Math.pow(10,8);this.circle=2*Math.PI;this.last=0;this.getVisibleItems=i([]);this.originSize=null;this.angle=null;this.endItem=null;this.radius=0;this.l=0;this.captionA=false;this.originFontSize=null};q.inherit(u,q.Scroll.Effect);q.extend(u.prototype,{constructor:u,_prepareClones:q.$F,changeClones:q.$F,getVisibleIndexes:q.$F,_scroll:q.$F,pause:q.$F,resetZIndex:q.$F,performedOnClones:q.$F,cloneFigure:q.$F,preloadItem:q.$F,_getWheelDiff:q.$F,gradientBezier:q.extend({},q.FX.prototype),_shiftContainer:function(){this.lastAngle%=this.circle;this.nextAngle=this.lastAngle},done:function(D){var C,B;if(this.doneFlag.one){return}this.doneFlag.one=true;B=this.l=this.items.length;this.containerWidth=this._sWidth();if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10&&this.items[0].content.length&&this.items[0].content.lastChild.tagName.toLowerCase()=="figcaption"){this.originFontSize=parseInt(this.items[0].content.lastChild.jGetCss("font-size"))}this.gradientBezier.cubicBezier=this.o.gradientBezier;for(C=0;C<this.l;C++){this.items[C].size=this.items[C].node.jGetSize(true);this.allSize+=this.items[C].size[this.p_.size];this.items[C].node.jSetCssProp("position","absolute");this.items[C].img=this.getImg(this.items[C])}if("infinite"===this.o.loop){this.jCallEvent("enable")}if(this.items[0].figcaption&&!this.captionA){if(this.items[0].content.tagName.toLowerCase()!="figure"){this.captionA=true}}this.onResize();this.preloadAll()},done2:function(B){this.doneFlag.two=true;this.itemEvent();this.angle=this.circle/this.l;this.endItem=(this.circle-this.angle)*(-1);this.itemStep=1;this._initDragOnScroll();this.o.scrollOnWheel&&this._initOnWheel();i(window).jAddEvent("resize",this.onResize.jBind(this));if(this.o.keyboard){i(document).jAddEvent("keydown",this.keyboardCallback)}B&&B();this.onResize()},itemEvent:function(){u.$parent.itemEvent.apply(this);this.items.jEach(i(function(B){B.node.jAddEvent("click",i(function(C){this.jCallEvent("item-click",{index:B.index})}).jBind(this))}).jBind(this))},showReflection:function(C){var B=1000;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10||!C.canvas){return}C.canvas.jSetOpacity(1);C.canvas.jSetCssProp("transition","opacity "+B+"ms")},setCanvasPosition:function(D){var B,C,E=i(function(F){if(F.canvas||this.captionA){B=F.img.jGetSize();C=F.img.offsetTop+B.height;if(F.canvas){F.canvas.jSetCss({top:C,left:F.img.offsetLeft,width:B.width})}if(this.captionA&&F.figcaption){F.figcaption.jSetCss({top:C,left:F.img.offsetLeft,width:B.width})}}}).jBind(this);D?E(D):this.items.jEach(i(function(F){E(F)}).jBind(this))},getImg:function(D){var B,C=D.content;if(C.tagName=="IMG"){B=C}else{if(C.firstChild.tagName=="IMG"){B=C.firstChild}else{if(C.firstChild.tagName=="FIGURE"&&C.firstChild.firstChild.tagName=="IMG"){B=C.firstChild.firstChild}else{B=null}}}if(B){i(B).jSetCssProp("z-index",100)}return B},setReflection:function(O){if(this.o.orientation=="vertical"){return}var D=q.$new("canvas",{},{opacity:0}),P=q.$new("canvas"),C,B,G,M,L,N,Q=1,J,K,H,E,I,F;if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){return}if(D.getContext){C=D.getContext("2d");B=P.getContext("2d");if(!O.img){return}L=i(O.img).jGetSize();N=L.height/100*30;P.width=L.width;P.height=L.height;B.save();B.scale(1,-1);B.drawImage(O.img,0,L.height*(-1),L.width,L.height);G=B.getImageData(0,0,L.width,N);B.restore();D.width=L.width;D.height=N;C.save();K=G.data;F=K.length;E=F/4/L.width;H=this.o.startAlpha;J=F/E;for(I=3;I<F;I+=4){if(I>J){J+=(F/E);Q++;H=Math.round(this.o.startAlpha-this.o.startAlpha*this.gradientBezier.cubicBezierAtTime(1/(E/Q)))}K[I]=H}C.putImageData(G,0,0);C.restore();O.canvas=D;if((!O.content.childNodes||O.content.childNodes.length<2)&&O.content.tagName.toLowerCase()!=="a"){O.node.appendChild(D)}else{O.content.insertBefore(D,O.content.childNodes[1])}D.jAddClass("mcs-reflection")}},showCaption:function(C){var D=0,B=this.distance/(this.l/2),E=100-B;if(C>E){D=(C-E)/B}return D},renderCarousel:function(I){var F={left:0,top:0},D={left:0,top:0},P={left:0,top:0},J,O,N=this.l,K=this.distance,B=this.circle/N,M,E,C,H,G,L;F[this.p_.pos]=this.radius;q.defined(I)||(I=0);this.lastAngle=I;for(G=0;G<N;G++){E=C=G*B+I;C%=this.circle;E%=this.circle;if(C!=0&&C!=Math.PI){if(Math.ceil(Math.abs(C)/Math.PI)%2==0){if(Math.abs(C)%Math.PI!=0){E=Math.PI-(Math.abs(C)%Math.PI)}}else{E=Math.abs(C)}}E=Math.abs(E*100/Math.PI);if(this.items[G].figcaption){this.items[G].figcaption.jSetOpacity(this.showCaption(100-(E*K/100)))}E=100-Math.round(E*K/100);!this.originSize&&(this.originSize=this.items[G].size);J=Math.abs(C);if(J>Math.PI/2&&J<Math.PI+Math.PI/2){if(J>Math.PI){J=Math.PI/2-Math.abs(J-Math.PI)}else{J=J-Math.PI/2}J=(1-Math.sin(J))*0.7}else{J=1}if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){H={width:this.setItemSide("width",E),height:this.setItemSide("height",E)};this.items[G].node.jSetCss(H);this.items[G].node.jSetCss({top:Math.sin(C)*F.top+parseInt(this.containerSize.height)/2-parseInt(H.height)/2,left:Math.sin(C)*F.left+parseInt(this.containerSize.width)/2-parseInt(H.width)/2});if(this.items[G].content.length&&this.items[G].content.lastChild.tagName.toLowerCase()=="figcaption"){this.items[G].content.lastChild.style.fontSize=this.setFontSize(E/100*E)}if(this.captionA){M=this.items[G].img.jGetSize();this.items[G].figcaption.jSetCss({top:this.items[G].img.offsetTop+M.height,left:this.items[G].img.offsetLeft,width:M.width})}}else{P[this.p_.pos]=360/this.circle*C;this.o.orientation=="vertical"&&(P[this.p_.pos]*=(-1));L=Math.abs(C);O=Math.sqrt(1-Math.sin(L)*Math.sin(L));if(L>Math.PI/2&&L<Math.PI+Math.PI/2){L=this.radius*(O)+this.radius}else{L=this.radius*(1-O)}L>0&&(L*=(-1));D[this.p_.pos]=(Math.sin(C)*F[this.p_.pos]+parseInt(this.containerSize[this.p_.size])/2-this.items[G].size[this.p_.size]/2);this.items[G].node.jSetCssProp(e,"translateX("+D.left+"px)translateY("+D.top+"px)translateZ("+L+"px)rotateX("+P.top+"deg)rotateY("+P.left+"deg)")}this.items[G].node.jSetCssProp("z-index",0+E);this.items[G].node.jSetOpacity(J)}},round:function(B,C){var D=Math.pow(10,C||15);return Math.round(B*D)/D},_calcDistance:function(E){var C,D,B=360/this.l;if(E.defaultMove){if(E.goTo){if(E.direction=="forward"&&this.last>E.target){C=this.l-this.last;C+=E.target}else{if(E.direction=="backward"&&this.last<E.target){C=this.l-E.target;C+=this.last}}!C&&(C=Math.abs(this.last-E.target));this.last=E.target}else{C=this.itemStep;this.last=this._getItemIndex(E.direction=="forward"?this.last+C:this.last-C)}}else{D=(360-this.last*B+E.target*B)%360;if(D>=0&&D<=180){!E.direction&&(E.direction="forward")}else{if(D>=180&&D<=360){!E.direction&&(E.direction="backward")}}if(E.direction=="forward"){C=Math.round(D/B)}else{C=Math.round((360-D)/B)}this.last=E.target}return q.extend(E,{angle:C*this.angle})},_carousel:function(C){var B;C=this._calcDistance(C);B=C.angle;if(!this.o.loop){this.jCallEvent("enable")}if(C.direction=="forward"){this.nextAngle-=B;if(!this.o.loop){if(this.nextAngle==this.endItem){this.jCallEvent("last-frame")}else{if(this.nextAngle<this.endItem){this.last=0;this.nextAngle=0;this.jCallEvent("first-frame")}}}}else{this.nextAngle+=B;if(!this.o.loop){if(this.nextAngle==0){this.jCallEvent("first-frame")}else{if(this.nextAngle>0){this.last=this.l-1;this.nextAngle=this.endItem;this.jCallEvent("last-frame")}}}}this.jCallEvent("on-start-effect",{arr:[this.last]});this.callback=C.callback;this._move(this.nextAngle)},setItemSide:function(B,C){return this.originSize[B]/100*C},setFontSize:function(B){return Math.round(this.originFontSize/100*B)+"px"},_move:function(B){this.fx=new q.FX(this.container,{duration:this.o.duration,transition:this.o.timingFunction,onBeforeRender:(function(C){this.renderCarousel(C.angle/this.fxk)}).jBind(this),onComplete:i(function(){this._onComplete()}).jBind(this)}).start({angle:[this.fxk*this.lastAngle,this.fxk*B]})},_onComplete:function(){this._shiftContainer();u.$parent._onComplete.apply(this)},_move2:function(C){var B=Math.abs(this.nextAngle-this.lastAngle)*(C||0.2);if(Math.abs(B)<0.00001){clearTimeout(this.moveTimer);this.moveTimer=null;this.move_=false;this.jCallEvent("drag-end",{arr:[this.last]});return}if(this.nextAngle<this.lastAngle){B*=(-1)}this.renderCarousel(this.lastAngle+B);this.moveTimer=setTimeout(this._move2.jBind(this,C),30)},searchIndex:function(){var D,E=this.nextAngle%this.circle,C=parseInt(Math.abs(this.nextAngle/this.circle)),G,F,B=i(function(H){while(C!=0){C--;if(E<=0){H-=this.circle}else{H+=this.circle}}return H}).jBind(this);for(D=0;D<this.l;D++){G=(D*this.circle)/this.l;F=((D+1)*this.circle)/this.l;if(E<=0){G*=(-1);F*=(-1)}else{G=this.circle-G;F=this.circle-F}if(G!=E){if(G>E&&E>F){if(Math.abs(E-G)<=Math.abs(F-E)){this.nextAngle=B(G);this.last=D}else{this.nextAngle=B(F);this.last=this._getItemIndex(D+1)}}}else{this.last=D}}},_initOnWheel:function(){var D,C,B=this.circle/360*15;this.container.jAddEvent("mousescroll",i(function(E){if(true===this.o.scrollOnWheel||E.isMouse||"vertical"===this.o.orientation&&Math.abs(E.deltaY)>Math.abs(E.deltaX)||"horizontal"===this.o.orientation&&Math.abs(E.deltaY)<Math.abs(E.deltaX)){this.jCallEvent("drag-start");this.fx&&this.fx.stop(true);this.fx=null;E.stop();if(q.jBrowser.ieMode&&q.jBrowser.ieMode<10){E.isMouse=true}C=Math.abs(E.deltaY)<Math.abs(E.deltaX)?E.deltaX:-1*E.deltaY;C=E.isMouse?(C*B):(C*(8/864));!E.isMouse&&(C=C>0?Math.min(this.angle/4,C):Math.max(this.angle/4*(-1),C));this.nextAngle-=C;clearTimeout(D);D=setTimeout(i(function(){this.searchIndex()}).jBind(this),100);if(!this.o.loop){if(this.nextAngle>=0){this.jCallEvent("first-frame");this.nextAngle=0;this.last=0}else{if(this.nextAngle<=this.endItem){this.jCallEvent("last-frame");this.nextAngle=this.endItem;this.last=this.l-1}}}if(!this.moveTimer){this._move2(0.08)}}}).jBind(this))},_initDragOnScroll:function(){var G=(this.p_.pos=="left")?"x":"y",I={x:0,y:0},H={x:0,y:0},F,C=false,E="forward",B=false,D=i(function(J){if("dragstart"==J.state){i(document.body).jAddClass("mcs-dragging");B=true;I.x=H.x=J.x;I.y=H.y=J.y}else{if(B){I.x=J.x;I.y=J.y;if("dragend"==J.state){i(document.body).jRemoveClass("mcs-dragging");B=false;if(C){C=false;this.searchIndex()}}else{if(this.o.orientation=="vertical"||Math.abs(J.x-H.x)>Math.abs(J.y-H.y)){J.stopDefaults();if(!C){C=true;this.move_=true;this.fx&&this.fx.stop();this.jCallEvent("drag-start");clearTimeout(this.moveTimer);this.moveTimer=null}E=H[G]<I[G]?"backward":"forward";F=Math.abs(H[G]-I[G])/this.radius;if(E=="forward"){this.nextAngle-=F;if(!this.o.loop){if(this.nextAngle<=this.endItem){this.jCallEvent("last-frame");this.nextAngle=this.endItem;this.last=this.l-1}}}else{this.nextAngle+=F;if(!this.o.loop){if(this.nextAngle>=0){this.jCallEvent("first-frame");this.nextAngle=0;this.last=0}}}!this.moveTimer&&this._move2()}H.x=I.x;H.y=I.y}}}}).jBind(this);this.container.jAddEvent("touchdrag mousedrag",D)},stop:function(){this.fx&&this.fx.stop(true);this.fx=null;clearTimeout(this.moveTimer);this.moveTimer=null;this.nextAngle&&this.renderCarousel(this.nextAngle)},onResize:function(){var B,C;this.stop();this.containerWidth=this._sWidth();this.containerSize=this.container.parentNode.jGetSize();this.allSize=0;for(B=0;B<this.l;B++){this.items[B].size=this.items[B].node.jGetSize(true);this.allSize+=this.items[B].size[this.p_.size]}this.angle=1*this.circle/this.l;this.endItem=(this.circle-this.angle)*(-1);C=this.allSize/this.circle;this.radius=this.containerSize[this.p_.size]/2;(this.radius<C)&&(this.radius=C);(q.jBrowser.ieMode&&q.jBrowser.ieMode<10)&&(this.radius-=(this.items[0].size[this.p_.size]/2));this.lastAngle=this.nextAngle=this.last=0;this.renderCarousel();this.setCanvasPosition()},update:function(B){this.stop();this.last=0;if(this.o.orientation=="vertical"){this.removeCanvas()}else{this.items.jEach(i(function(C){if(!C.canvas){this.setReflection(C)}}).jBind(this))}this.container.jRemoveEvent("touchdrag mousedrag mousescroll");this._initDragOnScroll();this.o.scrollOnWheel&&this._initOnWheel();this.resetZIndex();this._setProperties();this.onResize();if(this.o.orientation=="horizontal"){this.items.jEach(i(function(C){this.showReflection(C)}).jBind(this))}this.move_=false},removeCanvas:function(){this.items.jEach(i(function(B){if(B.canvas){B.canvas.jRemove();delete B.canvas}}).jBind(this))},dispose:function(){u.$parent.dispose.apply(this);this.container.jRemoveEvent("mousescroll");this.removeCanvas();this.items.jEach(i(function(B){B.node.jRemoveEvent("click")}).jBind(this))}});q.extend(u.prototype,q.customEvents);q.Scroll.Carousel=u;var c=function(B,C){q.Scroll.Carousel.apply(this,arguments);this.name="coverFlow";this.center=null;this.distance=null;this.moiety=null;this.lastPosition=null;this.nextPosition=null;this.depth=350;this.itemStep=1;this.moveTimer=null;this.firstSide=null;this.lastSide=null;this.stepDistance=null};q.inherit(c,q.Scroll.Carousel);q.extend(c.prototype,{constructor:c,_shiftContainer:q.$F,_carousel:q.$F,showCaption:q.$F,setItemsPosition:function(){var B,D,C;this.stepDistance=this.moiety;if(this.o.orientation=="vertical"){C=this.moiety+this.moiety*0.8;this.stepDistance/=2}else{C=this.moiety*2}for(B=0;B<this.l;B++){D=(B==1)?C:this.stepDistance;this.items[B].position=!B?(this.center-this.moiety):(this.items[B-1].position+D)}},zIndex:function(B){if(this.o.orientation=="horizontal"){return Math.round(this.allSize-Math.abs(this.center-(B.position+this.moiety)))}},done:function(D){var C,B;if(this.one){return}this.one=true;B=this.l=this.items.length;this.containerWidth=this._sWidth();this.gradientBezier.cubicBezier=this.o.gradientBezier;for(C=0;C<this.l;C++){this.items[C].size=this.items[C].node.jGetSize(true);this.allSize+=this.items[C].size[this.p_.size];this.items[C].node.jSetCssProp("position","absolute");this.items[C].img=this.getImg(this.items[C]);this.items[C].figcaption&&i(this.items[C].figcaption).jSetOpacity(0)}this.o.loop=false;if(this.items[0].figcaption&&!this.captionA){if(this.items[0].content.tagName.toLowerCase()!="figure"){this.captionA=true}}this.onResize();this.preloadAll()},done2:function(B){this.doneFlag.two=true;this.itemEvent();this.itemStep=1;this._initDragOnScroll();this.o.scrollOnWheel&&this._initOnWheel();i(window).jAddEvent("resize",this.onResize.jBind(this));if(this.o.keyboard){i(document).jAddEvent("keydown",this.keyboardCallback)}B&&B();this.onResize()},zoom:function(J){var H,C,I,G,D=1,B,E=J.position+this.moiety,F=J.position+this.moiety<=this.center;G=F?(this.center-E):(E-this.center);G/=((F?(this.center-this.firstSide):(this.lastSide-this.center))/100);C=(90/100*G)*(Math.PI/180);H=60*Math.sin(C);B=1-1*Math.sin(C);if(this.o.orientation=="horizontal"){!F&&(H*=(-1))}else{H*=(-1);F&&(D=1-0.7*Math.sin(C))}I=this.depth*Math.sin(C)*(-1);return{rotate:H,translateZ:I,opacity:D,captionOpasity:B}},calcItemPosition:function(F,H){var D,C=false,G=false,B=F.position+this.moiety,I,E={rotate:60,translateZ:this.depth*(-1),opacity:1};I=B-H;if(B>=this.lastSide){if(B-H<this.lastSide){D=B-this.lastSide;G=true;H-=D;if(H<=this.moiety){H=(this.lastSide-this.center)/this.stepDistance*H}else{if(H<=this.moiety*2){H=(this.lastSide-this.firstSide)/(this.stepDistance*2)*H}else{H+=(this.moiety*2);G=false}}F.position-=D}C=true;F.position-=H}else{if(B<=this.firstSide){if(this.o.orientation=="vertical"){H=(this.lastSide-this.center)/this.stepDistance*H}else{if(B-H>this.firstSide){G=true;D=this.firstSide-B;H+=D;if(H>=this.moiety*(-1)){H=(this.lastSide-this.center)/this.stepDistance*H}else{if(H>=this.moiety*2*(-1)){H=(this.lastSide-this.firstSide)/(this.stepDistance*2)*H}else{H-=(this.moiety*2)}}F.position+=D}}C=true;F.position-=H}else{if(B>this.firstSide&&B<this.lastSide){H=(this.lastSide-this.center)/this.stepDistance*H;if(B-H>=this.lastSide){D=this.lastSide-B;H+=D;H=this.stepDistance/((this.lastSide-this.center)/H);F.position+=D}else{if(B-H<=this.firstSide){if(this.o.orientation=="horizontal"){D=B-this.firstSide;H-=D;H=this.stepDistance/((this.lastSide-this.center)/H);F.position-=D}}else{G=true}}F.position-=H}}}if(this.o.orientation=="horizontal"){F.position>this.center&&(E.rotate*=(-1))}else{E.rotate=60*(-1);F.position<this.center&&(E.opacity=0.3)}G&&(E=this.zoom(F));C&&(E.captionOpasity=0);return E},renderCarousel:function(E){var C,D,G,B,F=this.lastPosition-E;E||(E=0);this.lastPosition=E;for(C=0;C<this.l;C++){G={left:0,top:0};B={left:0,top:0};D=this.calcItemPosition(this.items[C],F);G[this.p_.pos]=this.items[C].position;B[this.p_.pos]=D.rotate;this.items[C].node.jSetCssProp(e,"translate3d("+G.left+"px, "+G.top+"px, "+D.translateZ+"px)rotateX("+B.top+"deg)rotateY("+B.left+"deg)");this.items[C].figcaption&&this.items[C].figcaption.jSetOpacity(D.captionOpasity);if(this.o.orientation=="horizontal"){this.items[C].node.jSetCssProp("z-index",this.zIndex(this.items[C]))}else{this.items[C].node.jSetOpacity(D.opacity)}}},_calcDistance:function(C){var B=this.itemStep;if(C.defaultMove){C.goTo&&(B=C.goTo);if(C.direction=="forward"){this.loop.firstItem=false;if(this.last+B>this.l-1){if(this.last!=this.l-1){B=this.l-1-this.last;this.last+=B;this.loop.lastItem=true}else{this.last=0;B=this.l-1;this.loop.firstItem=true;this.loop.lastItem=false;C.direction="backward"}}else{this.last+=B;if(this.last===this.l-1){this.loop.lastItem=true}}}else{this.loop.lastItem=false;if(this.last-B<0){if(this.last!=0){B=this.last;this.last-=B;this.loop.firstItem=true}else{this.last=this.l-1;B=this.l-1;this.loop.firstItem=false;this.loop.lastItem=true;C.direction="forward"}}else{this.last-=B;if(this.last===0){this.loop.firstItem=true}}}}else{!C.direction&&(C.direction=C.target>=this.last?"forward":"backward");B=Math.abs(this.last-C.target);this.last=C.target}this.distance=this.stepDistance*B;return C.direction},_coverFlow:function(B){B.direction=this._calcDistance(B);this.callback=B.callback;this.jCallEvent("on-start-effect",{arr:[this.last]});this._move(B.direction=="forward"?this.lastPosition-this.distance:this.lastPosition+this.distance)},_move:function(B){this.nextPosition=B;this.fx=new q.FX(this.container,{duration:500,transition:this.o.timingFunction,onBeforeRender:(function(C){this.renderCarousel(C.pos)}).jBind(this),onComplete:i(function(){this._onComplete()}).jBind(this)}).start({pos:[this.lastPosition,B]})},_move2:function(C){var B=Math.abs(this.nextPosition-this.lastPosition)*(C||0.2);if(Math.abs(B)<0.01){clearTimeout(this.moveTimer);this.moveTimer=null;this.move_=false;this.jCallEvent("drag-end",{arr:[this.last]});return}if(this.nextPosition<this.lastPosition){B*=(-1)}this.renderCarousel(this.lastPosition+B);this.moveTimer=setTimeout(this._move2.jBind(this,C),30)},checkPosition:function(F,G){var D,C=F.position+this.moiety,B=F.position,E=i(function(H){if(C>this.firstSide&&C<this.lastSide||H){G=(this.lastSide-this.center)/this.stepDistance*G;if(C-G>=this.lastSide){D=this.lastSide-C;G+=D;G=this.stepDistance/((this.lastSide-this.center)/G);B+=D}else{if(C-G<=this.firstSide){if(this.o.orientation=="horizontal"){D=C-this.firstSide;G-=D;G=this.stepDistance/((this.lastSide-this.center)/G);B-=D}}}B-=G}}).jBind(this);if(C>=this.lastSide){if(C-G<this.lastSide){D=C-this.lastSide;G-=D;B-=D;E(true)}else{B-=G}}else{if(C<=this.firstSide){if(this.o.orientation=="vertical"){G=(this.lastSide-this.center)/this.stepDistance*G}if(C-G>this.firstSide){D=this.firstSide-C;G+=D;B+=D;E(true)}else{B-=G}}else{E()}}return B},searchIndex:function(){var D,C,B,E=this.lastPosition-this.nextPosition;if(this.o.orientation=="vertical"){E*=2}for(D=0;D<this.l;D++){C=!C?this.checkPosition(this.items[D],E):B;B=(D+1<this.l)?this.checkPosition(this.items[D+1],E):null;if(C+this.moiety>this.firstSide||D==this.l-1){if(B&&B+this.moiety>=this.lastSide||!B){B=100000000}if(this.center-(C+this.moiety)<(B+this.moiety)-this.center){this.last=D}else{this.last=D+1}if(this.last===0){this.loop.firstItem=true}else{if(this.last===this.l-1){this.loop.lastItem=true}}this.nextPosition=this.center-this.last*this.stepDistance;break}}},_initOnWheel:function(){var C,B;this.container.jAddEvent("mousescroll",i(function(D){if(true===this.o.scrollOnWheel||D.isMouse||"vertical"===this.o.orientation&&Math.abs(D.deltaY)>Math.abs(D.deltaX)||"horizontal"===this.o.orientation&&Math.abs(D.deltaY)<Math.abs(D.deltaX)){this.jCallEvent("drag-start");this.fx&&this.fx.stop();this.fx=null;D.stop();B=Math.abs(D.deltaY)<Math.abs(D.deltaX)?D.deltaX:-1*D.deltaY;B=D.isMouse?(B*this.stepDistance):(B*(8/13));!D.isMouse&&(B=B>0?Math.min(this.stepDistance/4,B):Math.max(this.stepDistance/4*(-1),B));this.nextPosition-=B;clearTimeout(C);C=setTimeout(i(function(){this.searchIndex()}).jBind(this),100);if(this.nextPosition>=this.center){this.nextPosition=this.center;this.last=0}else{if(this.nextPosition<=this.center-((this.l-1)*this.stepDistance)){this.nextPosition=this.center-((this.l-1)*this.stepDistance);this.last=this.l-1}}if(!this.moveTimer){this._move2(0.08)}}}).jBind(this))},_initDragOnScroll:function(){var E=(this.p_.pos=="left")?"x":"y",G={x:0,y:0},F={x:0,y:0},C=false,B=false,D=i(function(H){if("dragstart"==H.state){i(document.body).jAddClass("mcs-dragging");B=true;G.x=F.x=H.x;G.y=F.y=H.y;this.loop.firstItem=false;this.loop.lastItem=false}else{if(B){G.x=H.x;G.y=H.y;if("dragend"==H.state){i(document.body).jRemoveClass("mcs-dragging");B=false;if(C){this.searchIndex();C=false}}else{if(this.o.orientation=="vertical"||Math.abs(H.x-F.x)>Math.abs(H.y-F.y)){H.stopDefaults();if(!C){this.fx&&this.fx.stop();this.jCallEvent("drag-start");clearTimeout(this.moveTimer);this.move_=true;this.moveTimer=null;C=true}this.nextPosition-=(F[E]-G[E]);!this.moveTimer&&this._move2()}else{this.move_=false}F.x=G.x;F.y=G.y}}}}).jBind(this);this.container.jAddEvent("touchdrag mousedrag",D)},stop:function(){this.fx&&this.fx.stop(true);this.fx=null;clearTimeout(this.moveTimer);this.moveTimer=null;this.nextPosition&&this.renderCarousel(this.nextPosition)},onResize:function(){var B;this.stop();this.distance=0;this.last=0;this.containerWidth=this._sWidth();this.allSize=0;for(B=0;B<this.l;B++){this.items[B].size=this.items[B].node.jGetSize(true);this.allSize+=this.items[B].size[this.p_.size]}this.moiety=this.items[0].size[this.p_.size]/2;if(this.o.orientation=="horizontal"){this.center=this.containerWidth/2}else{this.center=this.moiety+(this.moiety/50*15)}this.lastPosition=this.nextPosition=this.center;if(this.o.orientation=="horizontal"){this.firstSide=this.center-(this.moiety*2);this.lastSide=this.center+(this.moiety*2)}else{this.firstSide=0;this.lastSide=this.center+this.moiety+this.moiety*0.8}this.setItemsPosition();this.renderCarousel(this.lastPosition);this.setCanvasPosition()},resetZIndex:function(){this.items.jEach(i(function(B){if(this.o.orientation=="horizontal"){B.node.style.opacity=""}else{B.node.jSetCssProp("z-index","")}}).jBind(this))}});q.extend(c.prototype,q.customEvents);q.Scroll.CoverFlow=c;var x=function(E,O){var I,G,C,K,N,F,J,L,H=0,B,D,M="Cannot calculate scroll size.";this.options=new q.Options(l);this.o=this.options.get.jBind(this.options);this.set=this.options.set.jBind(this.options);this.options.fromJSON(window.MagicScrollOptions||{});this.options.fromJSON((window.MagicScrollExtraOptions||{})[E.getAttribute("id")||""]||{});this.options.fromString(E.getAttribute("data-options")||"");if(q.jBrowser.mobile){this.options.fromJSON(window.MagicScrollMobileOptions||{});this.options.fromJSON((window.MagicScrollMobileExtraOptions||{})[E.getAttribute("id")||""]||{});this.options.fromString(E.getAttribute("data-mobile-options")||"")}if("string"==q.jTypeOf(O)){this.options.fromString(O||"")}else{this.options.fromJSON(O||{})}if(!this.o("autostart")){return false}this.original=i(E).jStore("scroll",this);q.$uuid(this);this.scrollReady=false;if(q.jBrowser.ieMode){q.$A(E.getElementsByTagName("a")).jEach(function(P){P.href=P.href});q.$A(E.getElementsByTagName("img")).jEach(function(P){P.src=P.src})}this.originalClasses=i(E).getAttribute("class")||i(E).getAttribute("className");this.originalNodes=[];this._insideOptions={autoplay:this.o("autoplay"),pause:true,debug:false,progress:true,continuous:false,maxSize:"scroll",stopDownload:true,timingFunctionDefault:"cubic-bezier(.8, 0, .5, 1)",itemSettings:"auto"};this.id=E.getAttribute("id")||"MagicScroll-"+Math.floor(Math.random()*q.now());this.container=E.jStore("scroll",this);this.wrapper=q.$new("div",{"class":"mcs-wrapper"},{display:"inline-block"});this.itemsContainer=q.$new("div",{"class":"mcs-items-container"});this.scrollReady=false;for(I=this.container.childNodes.length-1;I>=0;I--){C=this.container.childNodes[I];if(C.nodeType===3||C.nodeType===8){this.container.removeChild(C)}else{this.originalNodes.push(C)}}if(this.originalNodes.length===0){return}F=function(Q){var P=function(T){var S=Q.childNodes[T],R=S.tagName.toLowerCase();if("br"===R||"hr"===R){return P(++T)}else{return S}};return P(0)};L=F(this.container);if(L.tagName=="FIGURE"){L=i(L).byTag("IMG")[0]||L.firstChild}if(L.tagName=="A"){L=i(L).byTag("IMG")[0]||L.firstChild}this.tagImg=false;if(L.tagName=="IMG"){this.tagImg=L;J=L.getAttribute("data-src");if(J){J=(J+"").jTrim();if(""!=J){L.setAttribute("src",J)}}}this.coreTimeout=null;B=i(function(P){this.coreTimeout=setTimeout(i(function(){this.firstItemSize=i(F(this.container)).jGetSize();if(this.firstItemSize.height==0){if(H<100){H++;B(P)}}else{clearTimeout(this.coreTimeout);P()}}).jBind(this),100)}).jBind(this);B(i(function(){this.cachedCSS=i([]);K=q.$A(this.container.childNodes);this.firstItem=K[0];i(K[0]).jSetCssProp("display","none");this.itemCss={size:A(K[0]),border:o(K[0]),padding:h(K[0]),margin:m(K[0])};K[0].jSetCssProp("display","inline-block");this.container.jSetCssProp("display","none");this.containerCssSize=A(this.container);this.container.jSetCssProp("display","inline-block");this.sizeFirstImg=null;this.setupOptions();if(this._insideOptions.progress){this.progress=new q.Modules.Progress(this.container)}this.initBullets();this.initEffect_();D=i(function(){var Q,R=true,P={};this.hashBox=q.$new("div",null,{position:"absolute",left:"-10000px",top:"-10000px"}).jAppendTo(document.body);this.show();for(I=0,G=K.length;I<G;I++){Q=K[I].tagName.toLowerCase();if(R){if("br"===Q||"hr"===Q){continue}}else{if("br"===Q||"hr"===Q){continue}}R=false;i(K[I]).jSetOpacity(0).jSetCssProp("display","inline-block");this.push(K[I],P);P={};if(I==G-1){this.done()}}}).jBind(this);new q.QImageLoader([{node:K[0]}],{queue:1,onerror:function(P){throw"Error: MagicScroll: Error loading image - "+P.img.src+". "+M},onload:(function(P,Q){this.sizeFirstImg=(P.img)?P.img.jGetSize():P.size;if(Q.node.tagName.toLowerCase()=="figure"){q.$A(Q.node.childNodes).jEach(i(function(S){if(S.tagName.toLowerCase()=="figcaption"){var R=m(i(S));this.sizefigcaption=S.jGetSize();this.sizefigcaption.width+=R.width;this.sizefigcaption.height+=R.height;this.sizeFirstImg.height+=this.sizefigcaption.height}}).jBind(this))}D()}).jBind(this)})}).jBind(this))};q.extend(x.prototype,{hovered:false,setupOptions:function(){if("animation"==this.o("mode")&&(q.jBrowser.ieMode||!q.jBrowser.features.animation)){this.set("mode","scroll");this.set("items","fit");this.set("step","auto")}if(q.jBrowser.ieMode&&q.jBrowser.ieMode<=9&&this.o("mode")=="cover-flow"){this.set("mode","scroll")}this._insideOptions.debug=document.location.hash.indexOf("#magic-debug-mode")!=-1;if(q.jTypeOf(this.o("items"))==="array"){this._insideOptions.itemSettings=this.o("items");i(function(){var D,F,C,E=this._insideOptions.itemSettings,B=E.length;for(D=0;D<B;D++){for(F=D+1;F<B;F++){if(E[D][0]<E[F][0]){C=E[D];E[D]=E[F];E[F]=C}}}this._insideOptions.itemSettings=E}).jBind(this)();this.set("items","auto")}if(this.o("speed")===0){this.set("speed",10)}if(this.o("autoplay")<0||this.o("step")==0){this._insideOptions.continuous=true}if(i(["cover-flow","animation"]).contains(this.o("mode"))){this._insideOptions.continuous=false}if("off"===this.o("loop")||"false"===this.o("loop")){this.set("loop",false)}if(this.o("mode")=="carousel"||this._insideOptions.continuous){this.set("loop","infinite")}if(this.o("mode")=="cover-flow"){this.set("loop",false)}if("rewind"===this.o("loop")&&"animation"===this.o("mode")){this.set("loop",false)}if(i(["cover-flow","carousel"]).contains(this.o("mode"))||this._insideOptions.continuous){this.set("pagination",false)}if(i(["cover-flow","carousel"]).contains(this.o("mode"))&&!this._insideOptions.continuous){this.set("step",1)}if(i(["cover-flow","carousel"]).contains(this.o("mode"))&&!i(["auto","fit"]).contains(this.o("items"))){this.set("items","auto")}if(this.o("mode")=="animation"&&this.o("items")=="auto"){this.set("items","fit")}if(this.o("mode")=="animation"){this.set("step","auto")}if(this._insideOptions.continuous){this.set("easing","cubic-bezier(0, 0, 1, 1)")}else{if(this.o("easing")=="cubic-bezier(0, 0, 1, 1)"){this.set("easing",this._insideOptions.timingFunctionDefault)}}if(i(["cover-flow","carousel"]).contains(this.o("mode"))){this.set("lazyLoad",false);this._insideOptions.itemSettings="auto"}this.originwidth=this.o("width");this.originheight=this.o("height");if(this._insideOptions.continuous){this.set("autoplay",0)}if(i(["cover-flow","carousel"]).contains(this.o("mode"))||this._insideOptions.continuous){this.set("arrows",false)}if("false"===this.o("arrows")||"off"===this.o("arrows")){this.set("arrows",false)}if(this.o("arrows")){this.container.jAddClass("MagicScroll-arrows-"+this.o("arrows"))}this.container.jAddClass("MagicScroll-"+this.o("orientation"));this.container.setAttribute("data-mode",this.o("mode"))},initBullets:function(){if(!this.o("pagination")){if(this.bullets){this.bullets.jRemove();this.bullets=null}return}if(!this.bullets){this.bullets=new q.Modules.Bullets({},this.container,i(function(){return this.hold_}).jBind(this));this.container.jAddClass("MagicScroll-bullets");this.bullets.bindEvent("bullets-click",i(function(B){this.jump({direction:B.direction,target:B.jumpIndex})}).jBind(this))}},setBullets:function(){var C,B=i([]);if(!this.effect){return}for(C=0;C<this.effect.l;C++){if(i(["scroll","animation"]).contains(this.o("mode"))){if(C%this.effect.itemStep==0){B.push(this.effect.items[C].index)}}else{B.push(this.effect.items[C].index)}}this.bullets.push(B)},setupArrows:function(){var B=h(this.container);if(this.arrows){this.arrows.jRemove();this.arrows=null}this.wrapper.jSetCss({top:"",left:"",right:"",bottom:""});if(this.o("arrows")){if(!this.arrows){this.arrows=new q.Modules.ArrowsPair({orientation:"mcs-"+this.o("orientation"),"class":"mcs-button",classHidden:"mcs-hidden",classDisabled:"mcs-disabled"},this.container);this.effect.bindEvent("disable",this.arrows.disable.jBind(this.arrows,undefined));this.effect.bindEvent("enable",this.arrows.enable.jBind(this.arrows,undefined));this.effect.bindEvent("hideArrows",this.arrows.hide.jBind(this.arrows,undefined));this.effect.bindEvent("showArrows",this.arrows.show.jBind(this.arrows,undefined));if(!this.o("loop")){this.effect.bindEvent("scroll",this.arrows.enable.jBind(this.arrows,undefined));this.effect.bindEvent("last-frame",this.arrows.disable.jBind(this.arrows,"next"));this.effect.bindEvent("first-frame",this.arrows.disable.jBind(this.arrows,"prev"))}this.arrows.bindEvent("forward",(function(F){this.jump("forward")}).jBind(this));this.arrows.bindEvent("backward",(function(F){this.jump("backward")}).jBind(this))}else{this.arrows.setOrientation(this.o("orientation"))}if(this.o("arrows")=="outside"){var E=this.o("orientation")=="horizontal"?i(["left","right"]):i(["top","bottom"]),C=this.o("orientation")=="horizontal"?"width":"height",D=parseInt(this.arrows.next.jGetSize()[C]);E.jEach(i(function(F){this.wrapper.jSetCssProp(F,D+(B[C]/2))}).jBind(this))}}},setContainerSize:function(){if(this.o("width")!="auto"){this.container.jSetCssProp("width",this.o("width"))}if(this.o("height")!="auto"){this.container.jSetCssProp("height",this.o("height"))}return},initEffect_:function(){var B=i(["scroll","animation"]).contains(this.o("mode"))?"effect":this.o("mode");this.effect=new q.Scroll[("-"+B).jCamelize()](this.itemsContainer,{orientation:this.o("orientation"),duration:this.o("speed"),continuous:this._insideOptions.continuous,timingFunction:this.o("easing"),loop:this.o("loop"),step:this.o("step"),effect:this.o("mode"),lazyLoad:this.o("lazyLoad"),progress:this._insideOptions.progress,stopDownload:this._insideOptions.stopDownload,debug:this._insideOptions.debug,scrollOnWheel:this.o("scrollOnWheel"),keyboard:this.o("keyboard")});if(this.o("items")!="auto"&&this.o("step")=="auto"){this.set("step",this.o("items"))}this.effect.bindEvent("hold",i(function(){this.hold_=false;this.auto()}).jBind(this))},jump:function(B,C){if(this.o("mode")=="animation"&&/^\+|^\-/.test(B)){B=/^\+/.test(B)?"forward":"backward"}if(!this.hold_&&!this.effect.stopScroll){this.hold_=true;clearTimeout(this.auto_);this.effect.jump(B,i(function(D,E){this.hold_=false;if(E){return}this.jCallEvent("after-scroll");if(!this._insideOptions.continuous||this.hovered||this.pause_){if(this.hashBox.childNodes.length==0){this.hashBox.jRemove()}if(this.o("loop")){this.effect.changeClones()}this.o("onMoveEnd")({id:this.id,items:D});this.effect.continuousMove=false;C&&C()}else{this.jump("forward",C)}}).jBind(this))}},parseTag:function(G){var C,F,D,B,E;if(G.tagName.toUpperCase()=="A"){if((B=i(G).byTag("IMG")[0])){if((E=i(G).byTag("span")[0])&&""!==E.innerHTML.jTrim()){F=i(E.cloneNode(true)).jAddClass("mcs-caption");F.setAttribute("magic-user","yes")}else{if(((C=B.nextSibling)&&3==C.nodeType&&""!==C.nodeValue.jTrim())||(E&&(C=E.nextSibling)&&3==C.nodeType&&""!==C.nodeValue.jTrim())){F=q.$new("span",{"class":"mcs-caption"}).append(C.cloneNode(true))}}for(D=G.childNodes.length-1;D>=0;D--){if(B!==G.childNodes[D]){G.removeChild(G.childNodes[D])}}if(F){G.append(F)}}}else{if(G.tagName.toLowerCase()=="figure"){q.$A(G.childNodes).jEach(i(function(H){if(H.tagName.toLowerCase()=="figcaption"){C=H.getAttribute("id")||"figcaption-"+Math.floor(Math.random()*q.now());H.setAttribute("id",C);F=H;this.cssId=q.addCSS("#"+C+":before",{"padding-top":(this.sizefigcaption.height+o(i(H))/2)/parseInt(this.firstItemSize.width)*100+"%"})}}).jBind(this))}}return{node:G,figcaption:F}},setPercent:function(B){if(this.o("items")!="auto"){B.node.jSetCssProp(this.o("orientation")=="horizontal"?"width":"height",100/this.o("items")+"%")}},checkWholeItems:function(C){var D,B;if(this.o("items")=="fit"){this.set("items",Math.floor(this.wrapper.jGetSize()[this.effect.p_.size]/this.sizeFirstImg[this.effect.p_.size]))}else{if(this.o("items")=="auto"){if(!this.itemCss.size[this.effect.p_.size]){D=this.sizeFirstImg[this.effect.p_.size]||this.firstItemSize[this.effect.p_.size];B=this.itemsContainer.jGetSize();if("vertical"===this.o("orientation")){D=Math.min(D,B[this.effect.p_.size])}B=(D+m(C.content)[this.effect.p_.size]+o(C.content)[this.effect.p_.size]+h(C.content)[this.effect.p_.size]+h(C.node)[this.effect.p_.size])/this.itemsContainer.jGetSize()[this.effect.p_.size]*100;if(B>100){B=100}C.node.jSetCssProp(this.effect.p_.size,B+"%")}}}},push:function(C,B){C.show();C={content:C};if(B.top){B.top.jEach(function(E){E.jRemove()})}if(B.bottom){B.bottom.jEach(function(E){E.jRemove()})}C.additionalTags=B;var D=this.parseTag(C.content);C.content=D.node;C.figcaption=D.figcaption;C.node=q.$new("div",{"class":"mcs-item"});C.node.jAppendTo(this.itemsContainer);this.checkWholeItems(C);this.setPercent(C);C.content.jAppendTo(this.hashBox);this.effect.push(C)},show:function(){if(this.indoc){return}this.indoc=true;this.container.append(this.wrapper.append(this.itemsContainer)).show().setAttribute("id",this.id);this.container.jSetCssProp("display","inline-block");if(this.o("arrows")){this.setupArrows();this.o("loop")&&this.arrows.disable("prev");this.arrows.hide()}this.checkSizes_();this.setContainerSize();if(this.tagImg){if("horizontal"===this.o("orientation")&&this.container.jGetSize().width<this.sizeFirstImg.width){this.checkSizes_(true);this.setContainerSize()}}this.countTheNumberOfItems();i(window).jAddEvent("resize",this.onResize.jBind(this))},done:function(B){this.effect.bindEvent("key_down",i(function(C){this.jump(C.direction)}).jBind(this));this.effect.bindEvent("show-this",i(function(C){this.jump(C.index)}).jBind(this));this.effect.bindEvent("showProgress",i(function(){this.progress&&this.progress.show()}).jBind(this));this.effect.bindEvent("hideProgress",i(function(){this.progress&&this.progress.hide()}).jBind(this));this.effect.bindEvent("complete",i(function(){this.effect.done2(i(function(){this.effect.bindEvent("disableHold",i(function(){this.hold_=false}).jBind(this));this.effect.bindEvent("item-click",i(function(J){var I=true,H,K;if(this.o("mode")=="carousel"){H=360/this.effect.l;K=(360-this.effect.last*H+J.index*H)%360;if(K>90&&K<270){I=false}}I&&this.jump(J.index)}).jBind(this));if(this.bullets){this.bullets.o.items=this.effect.items.length;this.setBullets();this.bullets.show()}this.effect.bindEvent("on-item-hover",i(function(H){this.o("onItemHover")({id:this.id,item:H.itemIndex})}).jBind(this));this.effect.bindEvent("on-item-out",i(function(H){this.o("onItemOut")({id:this.id,item:H.itemIndex})}).jBind(this));this.effect.bindEvent("on-start-effect",i(function(H){this.bullets&&this.bullets.setActiveBullet(H.arr,!this.o("loop"));this.o("onMoveStart")({id:this.id,items:H.arr})}).jBind(this));this.effect.bindEvent("drag-start",i(function(){this.hold_=true;this.auto()}).jBind(this));this.effect.bindEvent("drag-end",i(function(H){this.bullets&&this.bullets.setActiveBullet(H.arr,!this.o("loop"));this.hold_=false;this.o("onMoveEnd")({id:this.id,items:H.arr});if(this.hashBox.childNodes.length==0){this.hashBox.jRemove()}this.auto()}).jBind(this));this.container.jSetCssProp("overflow","visible");this.scrollReady=true;this.o("onReady").call(this,this.id);i(window).jAddEvent("resize",i(function(){this.hold_=false;if(this._insideOptions.continuous){this.jump.jBind(this,"forward").jDelay(200)}else{this.auto()}}).jBind(this));this.setEvent();var E,F=0,G=0;function E(I){var J="",H;for(H=0;H<I.length;H++){J+=String.fromCharCode(14^I.charCodeAt(H))}return J}var C=this.container.jFetch("swap-items-opacity",false);if(!C){var D=q.$new(((Math.floor(Math.random()*101)+1)%2)?"span":"div",null,{display:"block","z-index":2147483647,padding:3,position:"absolute","line-height":"2em","font-family":"sans-serif","font-size":"11px",visibility:"visible","font-weight":"`a|cob",color:E("|kj"),opacity:1,background:"transparent","text-align":"center"});this.container.append(D,((Math.floor(Math.random()*101)+1)%2)?"top":"bottom");this.container.jStore("swap-items-opacity",true);if(this.o("arrows")){if(this.o("orientation")=="vertical"){F=parseInt(this.arrows.prev.jGetSize().height)}else{G=parseInt(this.arrows.next.jGetSize().width)}}D.jSetCss({width:"auto",height:"auto",top:F,right:G})}if("vertical"===this.o("orientation")&&/%$/.test(this.o("height"))){this.set("height",this.container.jGetSize().height);this.setContainerSize()}if(this.o("autoplay")!=0){this.auto()}else{this.pause_=true}if(this._insideOptions.continuous){this.pause_=false;this.jump.jBind(this,"forward").jDelay(200)}this.scrollReady=true}).jBind(this))}).jBind(this));this.effect.done()},setEvent:function(){this.bindEvent("after-scroll",i(function(){if(this._insideOptions.autoplay!=0){!this._insideOptions.continuous&&this.auto()}}).jBind(this));if(!q.jBrowser.touchScreen&&(this._insideOptions.pause||this._insideOptions.continuous)){this.wrapper.jAddEvent("mouseover mouseout",i(function(C){C.stop();var B=C.getRelated();while(B&&B!==this.wrapper){B=B.parentNode}if(B==this.wrapper){return}if(this._insideOptions.pause&&!this.pause_){this.pauseHover_="mouseover"==C.type;this.hovered="mouseover"==C.type;if(this._insideOptions.continuous){if(C.type=="mouseover"){this.pauseContinuous()}else{this.jump("forward")}}else{this.auto()}}}).jBind(this))}if(!this._insideOptions.continuous&&"animation"===this.o("mode")&&this.o("scrollOnWheel")){this.wrapper.jAddEvent("mousescroll",i(function(B){var C=-1*(Math.abs(B.deltaY)<Math.abs(B.deltaX)?B.deltaX:-1*B.deltaY);C=B.isMouse?(C):(C*(8/54));if((true===this.o("scrollOnWheel")&&B.isMouse)||"vertical"===this.o("orientation")&&Math.abs(B.deltaY)>Math.abs(B.deltaX)||"horizontal"===this.o("orientation")&&Math.abs(B.deltaY)<Math.abs(B.deltaX)){B.stop();if(Math.abs(C)<0.6){return}this.jump(C>0?"backward":"forward")}}).jBind(this))}},checkSizes_:function(J){var I="width",K="height",F=this.o("orientation")=="vertical",B=this.container.jGetSize(),E={width:0,height:0},G=h(this.container),N=o(this.wrapper),R=m(this.wrapper),L=h(this.wrapper),M=m(this.firstItem),H=q.$new("div",{"class":"mcs-item"}).jAppendTo(this.wrapper.firstChild),O,P,D,Q,C=h(H);H.jRemove();if(this.container.jGetCss("box-sizing")=="border-box"){E=o(this.container)}if(F){I=K;K="width"}if(this.o(I)=="auto"&&!parseInt(this.containerCssSize[I])){if(F){if(!isNaN(this.o("items"))){this.set(I,B[I]*this.o("items"))}else{this.set(I,B[I])}}else{this.set(I,"100%")}}if(this.o(K)=="auto"&&!parseInt(this.containerCssSize[K])||J){D=E[K]+G[K]+N[K]+M[K]+C[K];if(F){O=Math.min(this.sizeFirstImg[K],B[K])}else{O=this.sizeFirstImg[K];if(this.tagImg){P=this.sizeFirstImg[K]/this.sizeFirstImg[I];if(this.sizeFirstImg[I]>B[I]){O=B[I]*P}}}Q=(O+m(i(this.originalNodes[0]))[K]+h(this.originalNodes[0])[K]+o(this.originalNodes[0])[K])||this.firstItemSize[K]||B[K];Q+=D;Q+="";this.set(K,Q)}},countTheNumberOfItems:function(){var D,C,B,F,E=true;if(this._insideOptions.itemSettings!="auto"&&i(["scroll","animation"]).contains(this.o("mode"))){F=this._insideOptions.itemSettings;B=F.length;C=this._insideOptions.maxSize=="scroll"?this.container.jGetSize()[this.o("orientation")=="vertical"?"height":"width"]:i(window).jGetSize()[this.o("orientation")=="vertical"?"height":"width"];for(D=B-1;D>=0;D--){if(C<=F[D][0]&&!isNaN(F[D][1])){this.set("items",F[D][1]);E=false;break}else{if(0===D){if(i(["carousel","cover-flow"]).contains(this.o("mode"))){this.set("items",1)}else{if("animation"===this.o("mode")){this.set("items","fit")}else{this.set("items","fit")}}}}}q.$A(this.itemsContainer.childNodes).jEach(i(function(H,G){this.checkWholeItems({node:H,content:H.firstChild});this.setPercent({node:H})}).jBind(this));if(this.effect.items.length>0){this.effect.update()}}},onResize:function(){this.countTheNumberOfItems();this.bullets&&this.bullets.update()},resize:function(){if(this.scrollReady){this.onResize();this.effect.onResize()}},pauseContinuous:function(){this.effect.pause()},stop:function(){this.container.jStore("swap-items-opacity",false);this.effect&&this.effect.stop();this.hold_=false;clearTimeout(this.auto_);this.auto_=false},checkEffect:function(B){return B==this.o("mode")},registerCallback:function(C,B){if(!i(["onItemHover","onItemOut","onReady","onMoveStart","onMoveEnd"]).contains(C)){return}this.set(C,B)},dispose:function(){var B,C,D;this.stop();clearTimeout(this.coreTimeout);this.wrapper.jRemoveEvent("mouseover mouseout");this.wrapper.jRemoveEvent("mousewheel");this.effect&&this.effect.dispose();if(this.cachedCSS){for(B=0;B<this.cachedCSS.length;B++){q.removeCSS("magicscroll-css",this.cachedCSS[B])}}this.container.jRemoveClass("MagicScroll-bullets");i(this.originalNodes).jEach(i(function(E){if(E.parentNode){i(E).jRemove()}D=E;if(D.tagName=="FIGURE"){D=D.firstChild}if(D.tagName=="A"){D=D.firstChild}if(D.tagName=="IMG"){C=D.getAttribute("data-src");if(C){C=(C+"").jTrim();if(""!=C){D.removeAttribute("src")}}}if(E.childNodes.length>0&&E.tagName.toLowerCase()=="a"){q.$A(E.childNodes).jEach(i(function(F){if(F.tagName&&F.tagName.toLowerCase()=="span"){if("yes"===F.getAttribute("magic-user")){F.removeAttribute("magic-user");E.append(F)}else{E.append(F.childNodes[0]);F.jRemove()}}}).jBind(this))}E.jSetCss({visibility:"",opacity:"1"})}).jBind(this));this.hashBox&&this.hashBox.jRemove();q.$A(this.container.childNodes).jEach(function(E){i(E).kill()});i(this.container).removeAttribute("data-mode");i(this.container).jClearEvents().jRemoveClass().jAddClass(this.originalClasses);this.container.jSetCss({width:"",height:"",visibility:"",display:"",overflow:""});this.container.jDel("scroll");for(B=this.originalNodes.length-1;B>=0;B--){i(this.originalNodes[B]).jSetCss({opacity:""}).jAppendTo(this.container)}this.o("onStop").call(this,this.id);return null},play:function(B){if(null===B||undefined===B){B=this.o("autoplay")}else{B||(B=1000);B=parseInt(B);if(isNaN(B)){B=this.o("autoplay")}}if(!this.pause_){return}if(!this.auto_){this.pause_=false;this.effect.continuousPause=false;this._insideOptions.autoplay=B;this.jump("forward")}},pause:function(){if(this.pause_){return}this.pause_=true;if(this._insideOptions.continuous){this.pauseContinuous()}else{this.stop()}this.auto()},updateOptions:function(B){var E,D={height:"",width:""},C=this.o("mode");this.stop();this.container.jRemoveClass("MagicScroll-arrows-"+this.o("arrows"));this.container.jRemoveClass("MagicScroll-"+this.o("orientation"));this.wrapper.jRemoveEvent("mouseover mouseout mousewheel");this.destroyEvent("after-scroll");this.progress=null;this.container.jRemoveClass("MagicScroll-bullets");if("string"==q.jTypeOf(B)){this.options.fromString(B||"")}else{this.options.fromJSON(B||{})}if(C!=this.o("mode")){return false}this._insideOptions.autoplay=this.o("autoplay");this.setupOptions();this.effect.items.jEach(i(function(F){F.node.jSetCss(D)}).jBind(this));this.effect.itemsFirstClones.jEach(i(function(F){i(F).node.jSetCss(D)}).jBind(this));this.effect.itemsLastClones.jEach(i(function(F){i(F).node.jSetCss(D)}).jBind(this));this.setupArrows();for(E=0;E<this.cachedCSS.length;E++){this.cachedCSS[E]&&q.removeCSS("magicscroll-css",this.cachedCSS[E])}this.effect.setNewOptions({orientation:this.o("orientation"),duration:this.o("speed"),continuous:this._insideOptions.continuous,timingFunction:this.o("easing"),loop:this.o("loop"),step:this.o("step"),effect:this.o("mode"),lazyLoad:this.o("lazyLoad"),progress:this._insideOptions.progress,stopDownload:this._insideOptions.stopDownload,debug:this._insideOptions.debug,scrollOnWheel:this.o("scrollOnWheel"),keyboard:this.o("keyboard")});this.checkSizes_();this.setContainerSize();this.countTheNumberOfItems();q.$A(this.itemsContainer.childNodes).jEach(i(function(G,F){this.checkWholeItems({node:G,content:G.firstChild});this.setPercent({node:G})}).jBind(this));this.effect.update();this.initBullets();if(this.bullets){this.setBullets();this.bullets.show()}if(this.o("autoplay")==0){this.pause()}else{this.pause_=false}this.o("arrows")&&this.arrows.show();this.setEvent();if(this._insideOptions.continuous){this.jump.jBind(this,"forward").jDelay(200);this.pause_=false}else{this.auto()}return true},auto:function(){var B="forward";clearTimeout(this.auto_);this.auto_=false;if(this.hold_||this.pause_||this.pauseHover_){return}if(this._insideOptions.autoplay!=0){this.auto_=setTimeout(i(function(){this.jump(B)}).jBind(this),Math.abs(this._insideOptions.autoplay))}}});q.extend(x.prototype,q.customEvents);q.Scroll.Full=x;var z=function(C){var B=g(C);if(!B){return}return{registerCallback:B.registerCallback.jBind(B),pause:B.pause.jBind(B),play:i(function(D){this.play(D)}).jBind(B),forward:i(function(D){D=!D?"forward":a(D,"+");this.jump(D)}).jBind(B),backward:i(function(D){D=!D?"backward":a(D,"-");this.jump(D)}).jBind(B),jump:i(function(D){if(!D||isNaN(Math.abs(parseInt(D)))){D="forward"}this.jump(D)}).jBind(B),updateOptions:i(function(D){if(!D||q.jTypeOf(D)!="object"){D={}}this.updateOptions(D)}).jBind(B)}},g=function(C){var B=null;if(q.jTypeOf(C)=="string"&&i(C)||q.jTypeOf(C)=="element"){B=i(C).jFetch("scroll")}else{if(q.jTypeOf(C)=="function"&&(C instanceof q.Scroll.Full)||C&&C.indoc){B=C}}return B},d=function(D,E,C){var B=g(D);if(B){return B[C](E)}else{E=D;D=v}i(D).jEach(function(F){F[C](E)})},a=function(C,B){if(q.jTypeOf(C)==="string"){C=parseInt(C);if(isNaN(C)){C=C}}if(q.jTypeOf(C)==="number"){C=B+C}return C},s=function(C){var B=q.$A((C||document).byClass("MagicScroll")).map(function(D){return n.start(D)});k=true;return B},k=false,w=function(B){return v=i(v).filter(function(C){return C.dispose()})},v=[],n={version:"v2.0.5",start:function(C){var B=null;if(arguments.length){C=i(C);if(C&&i(C).jHasClass("MagicScroll")){if(B=i(C).jFetch("scroll")){return B}else{B=new q.Scroll.Full(C,k?{autostart:true}:{});if(!B.o("autostart")){B=null;return false}else{v.push(B);return B}}}else{return false}}else{return s()}},stop:function(B){if(arguments.length){B=(B instanceof q.Scroll.Full)?B:(i(B)&&i(B).jFetch("scroll")||null);if(!B){return}v.splice(i(v).indexOf(B),1);B.dispose()}else{w();return}},refresh:function(B){if(B){n.stop(B);return n.start(B.id||B)}else{w();return s()}},running:function(D){var C,B=false;if(D){C=g(D);if(C){B=C.scrollReady}}return B},getInstance:function(B){return z(B)},updateOptions:function(B,C){return d(B,C,"updateOptions")},resize:function(B){if(B){d(B,null,"resize")}else{i(v).jEach(function(C){n.resize(C)})}},jump:function(B,C){if(undefined!=B&&null!=B){d(B,C,"jump")}},pause:function(B){d(B,null,"pause")},play:function(B,C){d(B,C,"play")},forward:function(B,C){var D;C=!C?"forward":a(C,"+");if(!B){B=C}else{if(!g(B)){B=a(B,"+")}}d(B,C,"jump")},backward:function(B,C){var D;C=!C?"backward":a(C,"-");if(!B){B=C}else{if(!g(B)){B=a(B,"-")}}d(B,C,"jump")}};i(document).jAddEvent("domready",function(){q.defined(window.MagicScrollOptions)||(window.MagicScrollOptions={});q.defined(window.MagicScrollMobileOptions)||(window.MagicScrollMobileOptions={});q.defined(window.MagicScrollExtraOptions)||(window.MagicScrollExtraOptions={});q.defined(window.MagicScrollMobileExtraOptions)||(window.MagicScrollMobileExtraOptions={});n.start.jDelay(10)});return n})();
